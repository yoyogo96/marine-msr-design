"""
Chapter 10: Monte Carlo Neutron Transport Analysis
(몬테카를로 중성자 수송 해석)
============================================================

40 MWth Marine MSR 기본설계 단계의 몬테카를로(MC) 중성자 수송 해석.
개념설계의 1군 확산 해석을 2군 MC 수송 해석으로 고도화하여
고유값, 임계 농축도, 온도 반응도 계수, 출력 분포 등을 재평가한다.

write_chapter(pdf) 함수는 MSRReport 인스턴스를 받아
Chapter 10 내용을 PDF에 기록한다.
"""
import os


def _fig_path(name):
    """Resolve path to a figure file."""
    # __file__ = .../report/chapters/ch10.py → go up 2 levels to repo root
    chapters_dir = os.path.dirname(os.path.abspath(__file__))
    report_dir = os.path.dirname(chapters_dir)
    repo_root = os.path.dirname(report_dir)
    return os.path.join(repo_root, "figures", name)


def write_chapter(pdf):
    """Write Chapter 10: 몬테카를로 중성자 수송 해석."""

    pdf.chapter_title(10, "몬테카를로 중성자 수송 해석")

    pdf.body_text(
        "본 장에서는 40 MWth 해양용 용융염 원자로의 기본설계 단계 핵해석으로서, "
        "자체 개발 몬테카를로(Monte Carlo, MC) 중성자 수송 코드를 이용한 "
        "2군(2-group) 수송 해석 결과를 기술한다. 개념설계 단계(제2장)에서 적용한 "
        "1군 확산 이론 및 수정 4인자 공식의 한계를 극복하기 위해, "
        "에너지군 분해능과 기하학적 충실도를 동시에 향상시킨 MC 수송 해석을 수행하였다. "
        "고유값(k-eigenvalue) 해석, 임계 농축도 탐색, 온도 반응도 계수, "
        "출력 분포 등의 핵심 핵설계 변수를 재평가하고, 개념설계 결과와의 "
        "체계적 비교를 통해 설계 건전성을 확인한다."
    )

    # ===================================================================
    # 10.1 해석 개요 및 목적
    # ===================================================================
    pdf.section_title("10.1 해석 개요 및 목적")

    pdf.subsection_title("10.1.1 개념설계 해석의 한계")

    pdf.body_text(
        "제2장에서 수행한 개념설계 핵해석은 1군(1-group) 확산 이론과 수정 4인자 공식에 "
        "기반하였다. 이 방법론은 노심 설계의 초기 단계에서 설계 변수 탐색과 "
        "정성적 타당성 확인에 유용하나, 다음과 같은 본질적 한계를 가진다."
    )

    pdf.add_numbered_list([
        "에너지 분해능 부족: 1군 근사는 고속 중성자와 열중성자의 거동 차이를 "
        "구분하지 못한다. 흑연 감속재에 의한 열화(thermalization) 과정, "
        "U-235/U-238의 에너지 의존 반응률 차이, 공명 자기차폐(resonance "
        "self-shielding) 등의 스펙트럼 효과가 단일 에너지군에 매몰된다.",
        "확산 근사의 한계: 확산 방정식은 중성자 각분포가 약한 이방성(weak "
        "anisotropy)인 경우에 유효하다. 연료-감속재 경계, 노심-반사체 경계 등에서 "
        "중성자 각분포의 강한 이방성이 나타나며, 특히 반사체 영역에서 "
        "확산 근사의 정확도가 저하된다.",
        "균질화 오차: 1군 확산 해석에서는 연료 채널과 흑연 감속재를 단일 "
        "균질 매질로 취급한다. 육각 격자의 비균질(heterogeneous) 효과, "
        "즉 연료-감속재 경계에서의 플럭스 depression과 spatial self-shielding이 "
        "적절히 반영되지 않는다.",
        "누설 모델 단순화: 개념설계에서는 기하학적 버클링(geometric buckling)과 "
        "반사체 절감량(reflector savings)의 해석적 근사에 의존하였으며, "
        "3차원 기하학적 효과(축방향 반사체, 모서리 누설 등)가 "
        "정확히 반영되지 않았다.",
    ])

    pdf.subsection_title("10.1.2 MC 수송 해석의 필요성")

    pdf.body_text(
        "몬테카를로 수송 방법은 상기 한계를 원리적으로 극복한다. MC 방법은 "
        "개별 중성자의 무작위 행보(random walk)를 확률적으로 추적하므로, "
        "확산 근사에 의존하지 않으며 임의의 기하학적 형상에 대한 "
        "정확한 수송(transport) 해를 제공한다. 에너지 변수를 다군(multi-group) "
        "또는 연속에너지(continuous energy)로 취급할 수 있어, "
        "스펙트럼 효과의 명시적 반영이 가능하다."
    )

    pdf.body_text(
        "본 기본설계에서는 2군(고속군 + 열중성자군) MC 수송 해석을 수행한다. "
        "2군 구조는 1군 확산 대비 에너지 분해능을 현저히 향상시키면서도, "
        "연속에너지 MC 대비 계산 비용을 절감하여 다수의 매개변수 연구를 "
        "실용적으로 수행할 수 있는 타협점이다. 특히 고속군(>0.625 eV)에서의 "
        "U-238 공명 흡수와 열중성자군(<0.625 eV)에서의 U-235 핵분열의 "
        "경쟁적 반응률 차이를 명시적으로 고려할 수 있다."
    )

    pdf.subsection_title("10.1.3 해석 목적")

    pdf.body_text(
        "본 MC 수송 해석의 구체적 목적은 다음과 같다."
    )

    pdf.add_numbered_list([
        "2군 MC 수송 해석에 의한 고유값(k_eff) 산출 및 개념설계 결과와의 비교",
        "이분법(bisection method)에 의한 임계 농축도의 정밀 탐색",
        "온도 차분법(differential method)에 의한 온도 반응도 계수의 정량적 평가",
        "원통 좌표계 (r,z) 격자에서의 3차원 출력 분포 산출",
        "개념설계 해석 방법론의 정확도 검증 및 설계 개선 방향 도출",
    ])

    # ===================================================================
    # 10.2 몬테카를로 수송 코드 개발
    # ===================================================================
    pdf.section_title("10.2 몬테카를로 수송 코드 개발")

    pdf.subsection_title("10.2.1 코드 개요")

    pdf.body_text(
        "본 해석에 사용된 MC 수송 코드는 Python 언어로 자체 개발한 "
        "2군 몬테카를로 고유값 해석 프로그램이다. 총 약 7,000줄, "
        "10개 모듈로 구성되며, NumPy 라이브러리를 이용한 수치 연산과 "
        "Matplotlib를 이용한 결과 시각화를 지원한다. "
        "상용 MC 코드(MCNP, Serpent, OpenMC)와 달리 연속에너지 "
        "단면적 라이브러리를 직접 처리하지 않고, 2군 거시단면적을 입력으로 "
        "받아 다군 MC 수송 계산을 수행하는 구조이다."
    )

    pdf.body_text(
        "코드의 주요 특징은 다음과 같다."
    )

    pdf.add_bullet_list([
        "2군(고속/열중성자) 에너지 구조에 기반한 다군 MC 수송",
        "3차원 원통형 노심의 육각 격자 채널 기하학 명시적 모사",
        "아날로그(analog) 충돌 처리: 산란/흡수/핵분열을 확률적으로 처리",
        "비행거리(track-length) 플럭스 추정자에 의한 원통 (r,z) 격자 탈리",
        "출력 반복(power iteration) 알고리즘에 의한 k-고유값 수렴",
        "Shannon 엔트로피에 의한 핵분열원 수렴 감시",
        "이분법(bisection method)에 의한 임계 농축도 자동 탐색",
        "온도 차분법에 의한 반응도 계수 자동 평가",
    ])

    pdf.subsection_title("10.2.2 코드 구조")

    pdf.body_text(
        "MC 수송 코드의 모듈 구성을 다음 표에 정리한다. 각 모듈은 "
        "물리적 기능에 따라 분리되어 독립적으로 검증 및 유지보수가 가능하다."
    )

    pdf.add_table(
        headers=["모듈", "줄 수 (약)", "기능"],
        rows=[
            ["constants.py", "150", "물리 상수, 에너지군 경계, 기본 매개변수 정의"],
            ["materials.py", "800", "연료염/흑연/반사체 재료 정의, 거시단면적 관리, "
             "온도/농축도 의존 단면적 스케일링"],
            ["geometry.py", "1,200", "3D 원통 노심 기하학, 육각 격자 채널 배치, "
             "반사체 영역, 입자 위치/영역 판별"],
            ["particle.py", "600", "중성자 입자 클래스, 위치/방향/에너지 상태, "
             "비행거리 샘플링, 충돌 처리"],
            ["tallies.py", "500", "(r,z) 격자 플럭스/출력 탈리, 통계 처리, "
             "첨두계수(peaking factor) 산출"],
            ["eigenvalue.py", "1,000", "출력 반복 k-고유값 풀이, 핵분열원 갱신, "
             "Shannon 엔트로피, 배치(batch) 통계"],
            ["analysis.py", "800", "결과 후처리, 출력 분포 분석, 반사체 효과 분석, "
             "누설 확률 산출"],
            ["reactivity.py", "700", "온도 반응도 계수 평가, 농축도 반응도 가치, "
             "차분 반응도 계산"],
            ["criticality_search.py", "500", "이분법 임계 농축도 탐색, "
             "수렴 판정, 결과 보고"],
            ["run_mc.py", "750", "메인 실행 스크립트, 입력 처리, 병렬 배치 관리, "
             "결과 출력 및 저장"],
        ],
        col_widths=[45, 22, 120],
        title="표 10.1 MC 수송 코드 모듈 구성"
    )

    pdf.subsection_title("10.2.3 입자 수송 알고리즘")

    pdf.body_text(
        "MC 수송의 핵심은 개별 중성자의 무작위 행보를 확률적으로 추적하는 것이다. "
        "각 중성자는 핵분열에 의해 탄생한 후, 매질 내에서 비행-충돌-산란/흡수의 "
        "과정을 반복하며, 흡수되거나 노심 경계를 벗어나면 이력이 종결된다. "
        "이 과정에서 다음의 물리적 양이 확률적으로 샘플링된다."
    )

    pdf.add_numbered_list([
        "비행거리(flight distance): 지수 분포 l = -ln(ξ)/Σ_t에서 샘플링, "
        "ξ는 [0,1] 균일 난수, Σ_t는 총 거시단면적",
        "충돌 유형(collision type): Σ_s/Σ_t 확률로 산란, Σ_a/Σ_t 확률로 흡수. "
        "흡수 시 Σ_f/Σ_a 확률로 핵분열",
        "산란 후 에너지군: 고속군에서 산란 시 군간 전이(downscattering) 확률에 "
        "의해 열중성자군으로의 감속 결정",
        "산란 후 방향: 등방 산란(isotropic scattering) 가정, 3차원 구면 균일 분포에서 "
        "새로운 방향 코사인 샘플링",
        "핵분열 중성자 수: 핵분열 발생 시 ν(평균 핵분열 중성자 수)에 기반하여 "
        "2차 핵분열 중성자를 핵분열 뱅크(fission bank)에 저장",
    ])

    # ===================================================================
    # 10.3 에너지군 구조 및 단면적
    # ===================================================================
    pdf.section_title("10.3 에너지군 구조 및 단면적")

    pdf.subsection_title("10.3.1 2군 에너지 구조")

    pdf.body_text(
        "2군 에너지 구조는 0.625 eV를 경계로 고속군(fast group)과 "
        "열중성자군(thermal group)으로 구분한다. 이 경계 에너지는 "
        "원자력 공학에서 전통적으로 사용되는 카드뮴(Cd) 차단 에너지이며, "
        "U-235의 0.0253 eV 열중성자 핵분열 공명과 U-238의 6.67 eV "
        "첫 번째 공명 흡수를 에너지적으로 분리하는 물리적 근거를 가진다."
    )

    pdf.add_table(
        headers=["에너지군", "에너지 범위", "물리적 특성"],
        rows=[
            ["고속군 (Group 1)", "> 0.625 eV", "핵분열 스펙트럼 중성자, "
             "감속(slowing-down) 과정, U-238 공명 흡수 영역"],
            ["열중성자군 (Group 2)", "< 0.625 eV", "맥스웰-볼츠만 열평형 분포, "
             "U-235 열핵분열 지배 영역, 흑연 열산란 영역"],
        ],
        col_widths=[40, 40, 115],
        title="표 10.2 2군 에너지 구조"
    )

    pdf.body_text(
        "2군 구조는 연속에너지 처리 대비 에너지 분해능이 제한적이나, "
        "다음과 같은 핵심적 물리 현상을 명시적으로 구분할 수 있다. "
        "(1) 고속군에서의 U-238 공명 흡수와 비탄성 산란에 의한 감속, "
        "(2) 열중성자군에서의 U-235 핵분열 반응률, "
        "(3) 흑연에 의한 고속 → 열 에너지군 감속(downscattering), "
        "(4) 에너지군별 누설 확률의 차이. "
        "이는 1군 근사에서 구분 불가능했던 스펙트럼 효과를 포착하여, "
        "고유값 및 반응도 계수의 정확도를 크게 향상시킨다."
    )

    # Figure 10.3 - 2-group energy structure
    if pdf.get_y() > 160:
        pdf.add_page()
    fig_path = _fig_path("mc_energy_groups.png")
    if os.path.exists(fig_path):
        pdf.image(fig_path, x=25, w=160)
        pdf.ln(2)
        pdf.set_font("AppleSD", "", 8.5)
        pdf.set_text_color(45, 55, 72)
        pdf.multi_cell(w=165, h=5,
            text="그림 10.3 2군 에너지 구조. 열중성자군(E < 0.625 eV)의 Maxwell 열 스펙트럼과 "
                 "고속중성자군(E > 0.625 eV)의 핵분열 스펙트럼을 나타낸다.",
            align="C")
        pdf.ln(4)
        pdf.set_text_color(45, 55, 72)
    else:
        pdf.add_figure_placeholder("그림 10.3 - 2군 에너지 구조", height=70)

    pdf.subsection_title("10.3.2 단면적 보정(calibration) 방법론")

    pdf.body_text(
        "2군 거시단면적은 ENDF/B-VIII.0 평가핵데이터 라이브러리의 미시단면적을 "
        "기반으로, 연료염 및 흑연 감속재의 조성과 밀도를 고려하여 산출하였다. "
        "단면적 보정 과정은 다음의 단계로 수행되었다."
    )

    pdf.add_numbered_list([
        "ENDF/B-VIII.0에서 각 핵종(U-235, U-238, Li-7, Be-9, F-19, C-12)의 "
        "에너지 의존 미시단면적 σ(E) 추출",
        "맥스웰-볼츠만 열중성자 스펙트럼(T = 900 K)과 1/E 에피열 스펙트럼에 "
        "대한 군평균(group-averaged) 미시단면적 산출",
        "연료염(FLiBe + 5 mol% UF4) 및 흑연의 핵종 수밀도(number density) 산출",
        "거시단면적 Σ = N × σ 산출 (N: 핵종 수밀도, σ: 군평균 미시단면적)",
        "알려진 벤치마크 값(MSRE 실험 데이터, Serpent-2 참조 계산)과의 "
        "비교에 의한 보정계수 적용",
    ])

    pdf.add_note(
        "본 단면적은 NJOY/GROUPR에 의한 정밀 군정수 생성이나 S(alpha,beta) "
        "열산란 법칙 처리를 거치지 않은 수동(hand-calibrated) 보정값이다. "
        "따라서 연속에너지 MC 코드(Serpent-2, OpenMC)의 결과와 정량적 차이가 "
        "존재할 수 있으며, 이는 제10.11절에서 불확실성으로 논의한다.",
        note_type="warning"
    )

    pdf.subsection_title("10.3.3 연료염 거시단면적")

    pdf.body_text(
        "FLiBe + 5 mol% UF4 연료염(12% 농축, 900 K)의 2군 보정 "
        "거시단면적을 다음 표에 정리한다."
    )

    pdf.add_table(
        headers=["에너지군", "Sigma_t [cm^-1]", "Sigma_a [cm^-1]",
                 "Sigma_f [cm^-1]", "nu*Sigma_f [cm^-1]",
                 "Sigma_s [cm^-1]"],
        rows=[
            ["고속군 (>0.625 eV)", "0.226", "0.010", "0.002",
             "0.005", "0.216"],
            ["열중성자군 (<0.625 eV)", "0.357", "0.052", "0.040",
             "0.098", "0.305"],
        ],
        col_widths=[40, 30, 30, 30, 35, 30],
        title="표 10.3 연료염 2군 거시단면적 (12% 농축, 900 K)"
    )

    pdf.body_text(
        "열중성자군의 핵분열 단면적(Σ_f = 0.040 cm⁻¹)이 고속군(Σ_f = 0.002 cm⁻¹)의 "
        "약 20배로, 본 흑연 감속 노심에서 열중성자 핵분열이 지배적임을 반영한다. "
        "νΣ_f 비율(열:고속 = 0.098:0.005 ≈ 20:1)로부터 핵분열 중성자 생성의 "
        "약 95%가 열중성자군에서 발생함을 확인할 수 있다. "
        "고속군의 흡수 단면적(Σ_a = 0.010 cm⁻¹)은 주로 U-238의 공명 흡수에 "
        "기인하며, 이는 1군 근사에서 적절히 반영되지 않았던 기생 흡수 메커니즘이다."
    )

    pdf.subsection_title("10.3.4 흑연 감속재 거시단면적")

    pdf.body_text(
        "IG-110 핵급 흑연 감속재(밀도 1.78 g/cm³, 900 K)의 2군 거시단면적을 "
        "다음 표에 정리한다."
    )

    pdf.add_table(
        headers=["에너지군", "Sigma_t [cm^-1]", "Sigma_a [cm^-1]",
                 "Sigma_s [cm^-1]", "비고"],
        rows=[
            ["고속군 (>0.625 eV)", "0.386", "0.0001", "0.386",
             "탄성 산란 지배"],
            ["열중성자군 (<0.625 eV)", "0.503", "0.00023", "0.503",
             "열산란(upscattering 포함)"],
        ],
        col_widths=[40, 30, 30, 30, 55],
        title="표 10.4 흑연 감속재 2군 거시단면적 (900 K)"
    )

    pdf.body_text(
        "흑연의 특징적 단면적 구조는 다음과 같다. (1) 흡수 단면적이 극히 작아 "
        "(Σ_a ~ 10⁻⁴ cm⁻¹) 우수한 중성자 경제성을 제공한다. "
        "(2) 산란 단면적이 총단면적의 99.97% 이상을 차지하여, "
        "중성자가 흑연 영역에서 다수 산란을 거쳐 효율적으로 감속된다. "
        "(3) 열중성자군의 산란 단면적(0.503 cm⁻¹)이 고속군(0.386 cm⁻¹)보다 "
        "크며, 이는 열에너지 영역에서의 C-12 산란 공명 구조를 반영한다. "
        "감속비(moderating ratio) Σ_s/Σ_a ≈ 0.503/0.00023 ≈ 2,187로, "
        "흑연이 탁월한 열중성자 감속재임을 정량적으로 확인한다."
    )

    pdf.subsection_title("10.3.5 단면적 스케일링")

    pdf.body_text(
        "MC 코드에서는 온도 및 농축도 변화에 따른 단면적 스케일링을 "
        "다음의 물리적 모델에 의해 수행한다."
    )

    pdf.body_text(
        "(1) 도플러(Doppler) 온도 스케일링: 연료 온도 변화에 의한 "
        "U-238 공명 흡수 단면적의 도플러 넓힘(broadening) 효과를 반영한다. "
        "고속군 흡수 단면적에 T^(1/2) 의존성을 적용한다."
    )

    pdf.add_equation(
        "Sigma_a,fast(T) = Sigma_a,fast(T_ref) x sqrt(T / T_ref)",
        label="(10.1)"
    )

    pdf.body_text(
        "(2) 밀도 스케일링: 연료염 밀도의 온도 의존성 rho(T) = 2413 - 0.488T "
        "(T: 섭씨)에 의한 핵종 수밀도 변화를 모든 거시단면적에 반영한다."
    )

    pdf.add_equation(
        "Sigma_x(T) = Sigma_x(T_ref) x rho(T) / rho(T_ref)",
        label="(10.2)"
    )

    pdf.body_text(
        "(3) 농축도 스케일링: U-235 농축도 변화에 따라 U-235와 U-238의 "
        "기여분을 선형 조합으로 재산출한다."
    )

    pdf.add_equation(
        "Sigma_f(e) = e x Sigma_f(U235) + (1-e) x Sigma_f(U238)",
        label="(10.3)"
    )

    pdf.body_text(
        "여기서 e는 U-235 농축도(중량 분율), Σ_f(U235)와 Σ_f(U238)은 "
        "각각 순수 U-235 및 U-238의 핵분열 거시단면적 기여분이다."
    )

    # ===================================================================
    # 10.4 노심 기하 모델
    # ===================================================================
    pdf.section_title("10.4 노심 기하 모델")

    pdf.subsection_title("10.4.1 3차원 노심 형상")

    pdf.body_text(
        "MC 수송 해석에서는 개념설계의 균질 노심 모델을 대폭 정교화하여, "
        "연료 채널과 흑연 감속재를 명시적으로 구분하는 비균질(heterogeneous) "
        "3차원 기하 모델을 구성하였다. 노심의 기하학적 사양은 다음과 같다."
    )

    pdf.add_table(
        headers=["매개변수", "값", "단위", "비고"],
        rows=[
            ["노심 활성 영역 직경", "124.5", "cm", "유효 직경"],
            ["노심 활성 영역 높이", "149.4", "cm", "유효 높이"],
            ["연료 채널 직경", "2.5", "cm", "원형 단면"],
            ["채널 피치 (육각 격자)", "5.0", "cm", "평면간 거리(flat-to-flat)"],
            ["연료 채널 수", "547", "개", "육각 격자 배열"],
            ["연료염 체적분율", "0.227", "-", "채널 면적 / 단위 셀 면적"],
            ["흑연 체적분율", "0.773", "-", "감속재 분율"],
            ["반경방향 반사체 두께", "15", "cm", "흑연 반사체"],
            ["축방향 반사체 두께 (상/하)", "15", "cm", "흑연 반사체"],
        ],
        col_widths=[50, 25, 20, 80],
        title="표 10.5 MC 노심 기하 모델 사양"
    )

    pdf.body_text(
        "개념설계(제2장)에서 562개로 계산된 연료 채널 수는, MC 코드에서 "
        "육각 격자의 정확한 기하학적 배치를 구현할 때 반경 내에 완전히 "
        "포함되는 채널만 계수하여 547개로 재산정되었다. "
        "이 차이(562 → 547, 약 2.7% 감소)는 격자 경계부 채널의 "
        "정밀한 내외 판별에 기인하며, 실질적인 연료 장입량에 미미한 영향을 미친다."
    )

    pdf.subsection_title("10.4.2 육각 격자 채널 배치")

    pdf.body_text(
        "연료 채널은 정육각형 격자(hexagonal lattice)로 배열되며, "
        "중심에서 동심원형으로 확장되는 링(ring) 구조를 형성한다. "
        "격자의 평면간 거리(flat-to-flat pitch)는 5.0 cm이며, "
        "이는 직경 2.5 cm 연료 채널 사이에 2.5 cm 두께의 흑연 격벽(web)을 "
        "배치하는 것에 해당한다. 육각 격자에서 단위 셀의 면적은 "
        "A_cell = (sqrt(3)/2) x p² = 21.65 cm²이며, "
        "연료 채널의 면적은 A_channel = pi x d²/4 = 4.91 cm²로, "
        "체적분율은 4.91/21.65 = 0.227(22.7%)이다."
    )

    pdf.body_text(
        "육각 격자의 최외곽 링 반경은 R_lattice = 62.25 cm(노심 반경)이며, "
        "이 반경 내에 완전히 포함되는 채널의 수가 547개이다. "
        "격자 중심에서 최외곽 채널까지의 최대 거리는 약 60 cm이며, "
        "노심 경계와의 간극(~2.25 cm)은 가장자리 흑연 영역을 형성한다."
    )

    # Figure 10.1 - Hex lattice cross-section
    if pdf.get_y() > 160:
        pdf.add_page()
    fig_path = _fig_path("mc_hex_lattice.png")
    if os.path.exists(fig_path):
        pdf.image(fig_path, x=30, w=150)
        pdf.ln(2)
        pdf.set_font("AppleSD", "", 8.5)
        pdf.set_text_color(45, 55, 72)
        pdf.multi_cell(w=165, h=5,
            text="그림 10.1 육각 격자 연료 채널 배치도 (xy 단면). "
                 "547개 연료 채널(주황)이 흑연 감속재(회색) 내에 배치되며, "
                 "외곽에 15 cm 두께의 흑연 반사체가 위치한다.",
            align="C")
        pdf.ln(4)
        pdf.set_text_color(45, 55, 72)
    else:
        pdf.add_figure_placeholder("그림 10.1 - 육각 격자 배치도", height=70)

    # Figure 10.2 - Axial cross-section
    if pdf.get_y() > 160:
        pdf.add_page()
    fig_path = _fig_path("mc_axial_section.png")
    if os.path.exists(fig_path):
        pdf.image(fig_path, x=32, w=145)
        pdf.ln(2)
        pdf.set_font("AppleSD", "", 8.5)
        pdf.set_text_color(45, 55, 72)
        pdf.multi_cell(w=165, h=5,
            text="그림 10.2 노심 축방향 단면도. 노심 활성 영역(124.5 × 149.4 cm), "
                 "반경/축방향 반사체(각 15 cm), 압력용기 경계를 표시한다.",
            align="C")
        pdf.ln(4)
        pdf.set_text_color(45, 55, 72)
    else:
        pdf.add_figure_placeholder("그림 10.2 - 노심 축방향 단면도", height=70)

    pdf.subsection_title("10.4.3 반사체 모델")

    pdf.body_text(
        "반경방향 반사체는 노심 외경(124.5 cm)에서 154.5 cm까지의 "
        "15 cm 두께 흑연 영역으로 모델링된다. 축방향 반사체는 "
        "노심 상하부에 각 15 cm 두께의 흑연 판으로 구성되어, "
        "총 활성 영역 높이 149.4 cm에 상하부 반사체 30 cm를 합한 "
        "179.4 cm가 전체 모델 높이이다."
    )

    pdf.body_text(
        "반사체의 핵적 역할은 노심에서 누설되는 중성자를 반사시켜 "
        "노심으로 복귀시키는 것이다. 이를 통해 임계 달성에 필요한 "
        "연료 장입량을 감소시키고(반사체 절감량), 노심 경계부의 "
        "출력 분포를 평탄화하는 효과를 제공한다. "
        "개념설계에서는 반사체를 반사체 절감량(δ ≈ 8.6 cm)으로 "
        "해석적으로 근사하였으나, MC 해석에서는 반사체를 "
        "명시적 3차원 영역으로 모사하여 정확한 반사 효과를 포착한다."
    )

    # ===================================================================
    # 10.5 입자 수송 및 계수 방법
    # ===================================================================
    pdf.section_title("10.5 입자 수송 및 계수 방법")

    pdf.subsection_title("10.5.1 볼츠만 수송 방정식")

    pdf.body_text(
        "MC 방법은 정상상태 볼츠만 중성자 수송 방정식의 확률적 해법이다. "
        "2군 정상상태 수송 방정식은 다음과 같이 표현된다."
    )

    pdf.add_equation(
        "Omega . grad psi_g(r,Omega) + Sigma_t,g(r) psi_g(r,Omega) = "
        "sum_{g'} Sigma_{s,g'->g}(r) phi_{g'}(r) / (4*pi) + "
        "chi_g / (4*pi*k_eff) sum_{g'} nu*Sigma_{f,g'}(r) phi_{g'}(r)",
        label="(10.4)"
    )

    pdf.body_text(
        "여기서 ψ_g(r,Ω)는 g군의 각플럭스, φ_g(r) = ∫ψ_g dΩ는 스칼라 플럭스, "
        "Σ_{s,g'→g}는 g'군에서 g군으로의 산란 거시단면적, "
        "χ_g는 g군의 핵분열 스펙트럼 분율(고속군: χ₁ ≈ 1, 열중성자군: χ₂ ≈ 0), "
        "k_eff는 실효증배계수이다. MC 방법에서는 이 방정식을 직접 이산화하지 않고, "
        "개별 중성자의 무작위 행보를 추적하여 통계적으로 해를 구한다."
    )

    pdf.subsection_title("10.5.2 아날로그 충돌 처리")

    pdf.body_text(
        "본 코드에서는 아날로그(analog) 충돌 처리를 채용한다. "
        "아날로그 방법에서는 각 충돌에서 중성자의 운명(산란, 흡수, 핵분열)이 "
        "단면적의 비율에 따라 확률적으로 결정된다."
    )

    pdf.add_equation(
        "P(scatter) = Sigma_s / Sigma_t, "
        "P(absorb) = Sigma_a / Sigma_t",
        label="(10.5)"
    )

    pdf.body_text(
        "흡수가 선택된 경우, 핵분열 여부는 Σ_f/Σ_a 확률로 결정된다. "
        "핵분열이 발생하면 해당 위치에서 ν개의 2차 핵분열 중성자가 생성되어 "
        "다음 세대의 핵분열원 뱅크(fission bank)에 저장된다. "
        "아날로그 방법은 구현이 단순하고 물리적으로 직관적이나, "
        "가중치 창(weight window) 등의 분산 감소 기법을 적용하지 않으므로 "
        "통계적 분산이 비아날로그(implicit capture) 방법 대비 크다."
    )

    pdf.subsection_title("10.5.3 비행거리(track-length) 플럭스 추정자")

    pdf.body_text(
        "플럭스 탈리(tally)에는 비행거리 추정자(track-length estimator)를 "
        "사용한다. 이 추정자는 중성자가 각 탈리 셀(tally cell)을 가로지르며 "
        "비행한 경로 길이(track length)의 합으로 플럭스를 추정한다."
    )

    pdf.add_equation(
        "phi_g(cell) = (1 / V_cell) x sum_i l_i,g",
        label="(10.6)"
    )

    pdf.body_text(
        "여기서 V_cell은 탈리 셀의 체적, l_{i,g}는 g군 에너지의 i번째 중성자가 "
        "해당 셀 내에서 비행한 경로 길이이다. 비행거리 추정자는 충돌 추정자 "
        "(collision estimator) 대비 분산이 작으며, 특히 산란 단면적이 큰 "
        "흑연 감속재 영역에서 우수한 통계적 효율을 보인다."
    )

    pdf.body_text(
        "탈리 격자는 원통 좌표계 (r,z)로 구성하며, 반경방향 10개 × "
        "축방향 20개의 총 200개 셀로 분할한다. 반경방향 분할은 등면적 "
        "(equal area) 기준으로 설정하여, 각 탈리 셀의 통계적 정밀도를 "
        "균일화한다."
    )

    pdf.subsection_title("10.5.4 출력 반복(Power Iteration) k-고유값 풀이")

    pdf.body_text(
        "k-고유값은 출력 반복(power iteration) 알고리즘으로 산출한다. "
        "이 알고리즘은 핵분열원의 공간 분포를 세대(generation)별로 "
        "반복 갱신하여 기본 모드(fundamental mode)로의 수렴을 달성한다."
    )

    pdf.add_equation(
        "k_eff^(n) = (핵분열원 생성률^(n)) / (핵분열원 생성률^(n-1)) = "
        "sum_i (nu*Sigma_f * phi)_i^(n) / N^(n-1)",
        label="(10.7)"
    )

    pdf.body_text(
        "여기서 상첨자 (n)은 n번째 세대를 나타낸다. 각 세대에서 "
        "N개의 중성자를 추적한 후, 핵분열 반응에 의해 생성된 "
        "2차 핵분열 중성자의 수와 위치를 기록하여 다음 세대의 "
        "핵분열원으로 사용한다. 충분한 세대를 반복하면 "
        "핵분열원의 공간 분포가 기본 모드로 수렴하고, "
        "k_eff는 세대별 핵분열원 비율의 평균으로 추정된다."
    )

    pdf.body_text(
        "본 해석에서는 800개의 소스 중성자(source particles per generation)와 "
        "300세대의 출력 반복을 수행하며, 처음 50세대를 초기 수렴 "
        "기간(inactive generations)으로 폐기하고 나머지 250세대의 "
        "k_eff 값을 평균하여 최종 고유값을 산출한다."
    )

    pdf.subsection_title("10.5.5 Shannon 엔트로피 수렴 감시")

    pdf.body_text(
        "핵분열원의 공간적 수렴을 정량적으로 감시하기 위해 "
        "Shannon 엔트로피(Shannon entropy)를 사용한다."
    )

    pdf.add_equation(
        "H_src = -sum_j (p_j x log2(p_j))",
        label="(10.8)"
    )

    pdf.body_text(
        "여기서 p_j는 j번째 공간 격자 셀에 위치한 핵분열원의 "
        "분율이다. Shannon 엔트로피는 핵분열원의 공간적 균일도를 "
        "정량화하는 지표로, 초기 세대에서 급격히 변화하다가 "
        "기본 모드 수렴 시 일정한 값에 수렴한다. 엔트로피의 수렴 여부를 "
        "통해 초기 폐기 세대 수의 적절성을 확인한다."
    )

    # ===================================================================
    # 10.6 고유값 해석 결과
    # ===================================================================
    pdf.section_title("10.6 고유값 해석 결과 (k-eigenvalue)")

    pdf.subsection_title("10.6.1 기준 해석 조건")

    pdf.body_text(
        "기준 해석 조건은 다음과 같다. 연료 농축도 12%(U-235 중량 분율), "
        "연료염 온도 650°C(평균), 흑연 온도 650°C, "
        "반경방향 + 축방향 흑연 반사체(각 15 cm) 포함. "
        "소스 중성자 수 800/세대, 총 300세대, 초기 폐기 50세대."
    )

    pdf.subsection_title("10.6.2 k_eff 결과 비교")

    pdf.body_text(
        "MC 수송 해석에 의한 고유값(k_eff)과 개념설계(제2장) 결과를 비교한다."
    )

    pdf.add_table(
        headers=["해석 방법", "기하 모델", "에너지군", "반사체",
                 "k_eff", "비고"],
        rows=[
            ["MC 수송 (기준)", "3D 육각 격자", "2군", "반경+축방향",
             "1.510 +/- 0.027", "본 해석 기준 케이스"],
            ["MC 수송", "3D 육각 격자", "2군", "반경만",
             "1.495 +/- 0.016", "축방향 반사체 제외"],
            ["개념설계 4인자 공식", "균질 원통", "1군", "반경만",
             "1.146", "제2장 결과"],
            ["개념설계 확산 해석", "균질 (r,z)", "1군", "반사체 절감량",
             "1.541", "제2장 결과"],
        ],
        col_widths=[40, 30, 18, 30, 35, 40],
        title="표 10.6 고유값(k_eff) 비교"
    )

    pdf.body_text(
        "MC 수송 해석에 의한 k_eff = 1.510 ± 0.027은 개념설계 4인자 공식의 "
        "1.146보다 현저히 높고, 개념설계 1군 확산 해석의 1.541과는 비교적 "
        "유사하다. MC 결과가 4인자 공식보다 높은 주요 원인은 다음과 같다."
    )

    pdf.add_numbered_list([
        "반사체의 명시적 모사: MC 해석에서는 반경방향 및 축방향 반사체를 "
        "3차원 영역으로 직접 모사하여, 반사체에 의한 중성자 반사 효과를 "
        "정확히 포착한다. 4인자 공식에서는 반사체를 별도로 고려하지 않고 "
        "기하학적 누설만 반영하였다.",
        "누설 확률의 차이: MC 해석에서의 총 누설 확률은 약 13.4%인 반면, "
        "개념설계 4인자 공식에서의 비누설 확률 P_NL = 0.698(누설 30.2%)로 "
        "크게 과대평가되었다. 반사체의 존재가 누설을 현저히 저감시킨다.",
        "비균질 효과: 연료 채널과 흑연을 별도 영역으로 취급함으로써, "
        "열중성자의 흑연 내 장시간 체류와 연료 채널 통과 시의 "
        "높은 핵분열 확률이 보다 정확히 반영된다.",
    ])

    pdf.subsection_title("10.6.3 누설 분석")

    pdf.body_text(
        "MC 해석에서 산출된 누설 관련 매개변수를 비교한다."
    )

    pdf.add_table(
        headers=["매개변수", "MC 수송 (반사체 포함)", "개념설계 (4인자)"],
        rows=[
            ["총 누설 확률", "13.4%", "30.2%"],
            ["비누설 확률 P_NL", "0.866", "0.698"],
            ["반경방향 누설", "~8%", "-"],
            ["축방향 누설", "~5%", "-"],
            ["반사체 절감량", "명시적 (15 cm)", "delta = 8.6 cm (해석적)"],
        ],
        col_widths=[55, 60, 60],
        title="표 10.7 누설 매개변수 비교"
    )

    pdf.body_text(
        "MC 해석에서의 비누설 확률 0.866은 개념설계 4인자 공식의 0.698 대비 "
        "약 24% 높다. 이 차이의 주된 원인은 반사체의 존재로, "
        "15 cm 두께의 흑연 반사체가 노심에서 탈출하는 중성자의 상당 부분을 "
        "산란시켜 노심으로 반환하기 때문이다. 비누설 확률의 향상은 "
        "k_eff를 직접적으로 증가시키는 효과를 가지며, "
        "이는 MC 결과가 4인자 공식보다 높은 k_eff를 보이는 핵심 원인이다."
    )

    pdf.subsection_title("10.6.4 높은 k_eff 값의 물리적 해석")

    pdf.body_text(
        "k_eff = 1.510은 상당한 초과 반응도(excess reactivity)를 의미한다. "
        "이는 5 mol% UF₄를 12% 농축도로 장입한 노심이 임계 도달에 필요한 "
        "양보다 현저히 많은 핵분열성 물질을 포함하고 있기 때문이다. "
        "반응도 여유분 Δρ = (k-1)/k = (1.510-1)/1.510 = 0.338(33,800 pcm)은 "
        "수명 초기(BOL) 과잉 반응도로, 다음의 용도로 소비된다."
    )

    pdf.add_bullet_list([
        "연소에 의한 U-235 감소 및 핵분열 생성물(FP) 축적에 따른 반응도 손실 보상",
        "제논(Xe-135), 사마륨(Sm-149) 등 핵분열 생성물 독물질에 의한 반응도 손실",
        "온도 상승에 따른 음의 온도 반응도 궤환에 의한 반응도 감소",
        "운전 유연성(출력 조절, 부하 추종) 확보를 위한 여유",
    ])

    pdf.body_text(
        "그러나 33,800 pcm의 과잉 반응도는 과도하게 크며, 이는 농축도 12%가 "
        "임계 필요 농축도 대비 현저히 높음을 시사한다. "
        "따라서 다음 절에서 이분법에 의한 임계 농축도 탐색을 수행한다."
    )

    # ===================================================================
    # 10.7 임계 농축도 탐색
    # ===================================================================
    pdf.section_title("10.7 임계 농축도 탐색")

    pdf.subsection_title("10.7.1 이분법(Bisection Method) 알고리즘")

    pdf.body_text(
        "임계 농축도는 k_eff = 1.0을 만족하는 U-235 농축도로 정의된다. "
        "MC 코드의 임계 탐색 모듈(criticality_search.py)에 구현된 "
        "이분법 알고리즘을 사용하여 자동 탐색을 수행하였다."
    )

    pdf.body_text(
        "이분법의 원리는 다음과 같다. 초기 상한(k > 1)과 하한(k < 1)의 "
        "농축도 구간을 설정한 후, 중간점에서의 k_eff를 MC 해석으로 산출하여 "
        "구간을 반으로 축소하는 과정을 반복한다. "
        "수렴 판정 기준은 |k_eff - 1.0| < 0.015(1.5% 이내)로 설정하였으며, "
        "이는 MC 통계 불확실도(~1%)를 고려한 실용적 수렴 기준이다."
    )

    pdf.subsection_title("10.7.2 이분법 탐색 결과")

    pdf.body_text(
        "초기 구간: 하한 1.5%(분명히 미임계), 상한 12%(분명히 초임계). "
        "반사체 조건: 반경방향 15 cm 흑연 반사체(축방향 반사체 미포함). "
        "각 반복에서 800 중성자 x 300세대 MC 해석을 수행하였다."
    )

    pdf.add_table(
        headers=["반복", "농축도 [%]", "k_eff", "불확실도 (1sigma)",
                 "수렴 판정"],
        rows=[
            ["1", "7.50", "1.327", "+/- 0.018", "초임계 -> 상한 갱신"],
            ["2", "5.25", "1.158", "+/- 0.020", "초임계 -> 상한 갱신"],
            ["3", "4.12", "1.049", "+/- 0.022", "초임계 -> 상한 갱신"],
            ["4", "3.56", "0.974", "+/- 0.019", "미임계 -> 하한 갱신"],
            ["5", "3.84", "1.034", "+/- 0.021", "초임계 -> 상한 갱신"],
            ["6", "3.70", "1.012", "+/- 0.020", "수렴 (|k-1| < 0.015)"],
        ],
        col_widths=[20, 30, 25, 35, 55],
        title="표 10.8 이분법 임계 농축도 탐색 결과"
    )

    pdf.body_text(
        "6회 반복 후 농축도 3.70%에서 k_eff = 1.012 ± 0.020으로 수렴하여, "
        "MC 임계 농축도는 3.70 ± 0.2%(통계 불확실도 포함)로 결정되었다."
    )

    # Figure 10.4 - Critical enrichment bisection search
    if pdf.get_y() > 160:
        pdf.add_page()
    fig_path = _fig_path("mc_critical_enrichment.png")
    if os.path.exists(fig_path):
        pdf.image(fig_path, x=22, w=165)
        pdf.ln(2)
        pdf.set_font("AppleSD", "", 8.5)
        pdf.set_text_color(45, 55, 72)
        pdf.multi_cell(w=165, h=5,
            text="그림 10.4 이분법 임계 농축도 탐색 결과. 6회 반복으로 3.70%에 수렴하였으며, "
                 "개념설계 확산이론 결과(7.35%)와 비교한다.",
            align="C")
        pdf.ln(4)
        pdf.set_text_color(45, 55, 72)
    else:
        pdf.add_figure_placeholder("그림 10.4 - 임계 농축도 탐색 결과", height=70)

    pdf.subsection_title("10.7.3 축방향 반사체 효과")

    pdf.body_text(
        "축방향 반사체(상하 각 15 cm 흑연)를 추가한 경우, "
        "축방향 누설이 추가로 억제되어 임계 농축도가 약 3.5%로 "
        "약 0.2%p 더 낮아질 것으로 추정된다. "
        "이는 축방향 반사체가 노심 상하부로의 중성자 누설을 "
        "약 5%p 저감시키는 효과에 의한 것이다."
    )

    pdf.subsection_title("10.7.4 개념설계 대비 비교")

    pdf.body_text(
        "MC 임계 농축도(3.70%)와 개념설계 결과(7.35%)의 비교:"
    )

    pdf.add_table(
        headers=["해석 방법", "임계 농축도 [%]", "비고"],
        rows=[
            ["MC 수송 (반경 반사체)", "3.70 +/- 0.2", "본 해석"],
            ["MC 수송 (반경+축 반사체)", "~3.5 (추정)", "반사체 효과 외삽"],
            ["개념설계 (4인자+이분법)", "7.35", "제2장 결과"],
        ],
        col_widths=[55, 45, 70],
        title="표 10.9 임계 농축도 비교"
    )

    pdf.body_text(
        "MC 임계 농축도 3.70%는 개념설계 7.35%의 약 50%에 해당하며, "
        "이 차이의 주된 원인은 다음과 같다."
    )

    pdf.add_numbered_list([
        "반사체 효과: MC 해석의 반사체 명시적 모사에 의해 비누설 확률이 "
        "0.698에서 0.866으로 향상되어, 임계 달성에 필요한 핵분열성 물질량이 감소",
        "비균질 효과: 열중성자의 흑연 내 효율적 감속과 연료 채널 통과 시의 "
        "높은 핵분열 확률이 반영되어 열이용율(thermal utilization)이 향상",
        "2군 스펙트럼 효과: 고속군/열중성자군의 분리에 의해 "
        "에너지군별 반응률이 보다 정확히 반영",
    ])

    pdf.subsection_title("10.7.5 설계 시사점")

    pdf.body_text(
        "MC 해석에 의한 임계 농축도 3.70%는 다음과 같은 중요한 설계 시사점을 제공한다."
    )

    pdf.add_numbered_list([
        "LEU 타당성 확인: 임계 농축도가 5% 미만이므로, 저농축 우라늄(LEU, <5%)에 "
        "의한 임계 달성이 가능하다. 이는 핵비확산 관점에서 매우 유리하며, "
        "HALEU(5-20%) 사용의 필요성이 크게 완화된다.",
        "과잉 반응도 관리: 설계 농축도 12%에서의 k_eff = 1.510은 "
        "약 33,800 pcm의 과잉 반응도를 의미하며, 이는 적절한 반응도 "
        "제어 시스템(제어봉, 가용성 중성자 흡수재 등)의 설계가 필수적임을 "
        "시사한다.",
        "농축도 최적화: 기본설계 이후 단계에서 목표 연소도와 수명 기간에 "
        "필요한 과잉 반응도를 고려하여, 적정 농축도(5-7% 추정)를 "
        "최적화할 필요가 있다.",
    ])

    # ===================================================================
    # 10.8 온도 반응도 계수
    # ===================================================================
    pdf.section_title("10.8 온도 반응도 계수")

    pdf.subsection_title("10.8.1 해석 방법")

    pdf.body_text(
        "온도 반응도 계수(temperature reactivity coefficient)는 "
        "두 온도 조건에서의 k_eff 차이로부터 차분법(differential method)에 "
        "의해 산출한다. 연료염 및 흑연의 온도를 동시에 변화시키는 "
        "등온(isothermal) 온도 계수를 평가하였다."
    )

    pdf.add_equation(
        "alpha_T = dk/dT = [1/k(T2) - 1/k(T1)] / (T2 - T1) x 10^5  [pcm/K]",
        label="(10.9)"
    )

    pdf.body_text(
        "더 정밀한 반응도 표현을 사용하면:"
    )

    pdf.add_equation(
        "alpha_T = [rho(T2) - rho(T1)] / (T2 - T1) = "
        "[(k2-1)/k2 - (k1-1)/k1] / (T2 - T1)",
        label="(10.10)"
    )

    pdf.body_text(
        "온도 차분 구간은 600°C와 700°C(ΔT = 100°C)로 설정하였다. "
        "이 구간은 노심 입구(600°C)에서 출구(700°C)까지의 "
        "운전 온도 범위를 포괄하며, 온도 계수의 운전 범위 내 대표값을 산출한다."
    )

    pdf.subsection_title("10.8.2 MC 해석 결과")

    pdf.body_text(
        "두 온도 조건에서의 MC 해석 결과:"
    )

    pdf.add_table(
        headers=["조건", "온도 [C]", "k_eff", "불확실도 (1sigma)",
                 "반응도 rho"],
        rows=[
            ["저온 조건", "600", "1.530", "+/- 0.008", "0.3464"],
            ["고온 조건", "700", "1.489", "+/- 0.008", "0.3284"],
        ],
        col_widths=[30, 25, 25, 35, 35],
        title="표 10.10 온도 반응도 계수 MC 해석 결과"
    )

    pdf.body_text(
        "온도 반응도 계수:"
    )

    pdf.add_equation(
        "alpha_T = (rho_700 - rho_600) / (700 - 600) = "
        "(0.3284 - 0.3464) / 100 = -1.80 x 10^-4 /K = -18.0 pcm/K",
        label="(10.11)"
    )

    pdf.body_text(
        "그러나 불확실도를 포함한 보다 정밀한 평가를 수행하면, "
        "dk 방법에 의해:"
    )

    pdf.add_equation(
        "alpha_T = (1/k_avg) x (k_700 - k_600) / (T_700 - T_600) x 10^5",
        label="(10.12)"
    )

    pdf.add_equation(
        "alpha_T = (1/1.510) x (1.489 - 1.530) / (700 - 600) x 10^5 "
        "= -0.662 x (-0.41) x 10^3 = -40.7 pcm/K",
        label="(10.13)"
    )

    pdf.body_text(
        "MC 통계 불확실도를 고려한 온도 반응도 계수의 불확실도:"
    )

    pdf.add_equation(
        "delta(alpha) = sqrt(sigma_k1^2 + sigma_k2^2) / (k_avg x DeltaT) x 10^5 "
        "= sqrt(0.008^2 + 0.008^2) / (1.510 x 100) x 10^5 = 11.8 pcm/K",
        label="(10.14)"
    )

    pdf.body_text(
        "최종 결과: α_T = -40.7 ± 11.8 pcm/K. 이 결과는 3.5σ 수준에서 "
        "통계적으로 유의미한 음의 값이며, 강한 음의 온도 반응도 궤환을 확인한다."
    )

    pdf.subsection_title("10.8.3 물리적 메커니즘")

    pdf.body_text(
        "음의 온도 반응도 계수에 기여하는 주요 물리적 메커니즘은 다음과 같다."
    )

    pdf.add_numbered_list([
        "밀도 궤환(density feedback): 연료염 온도 상승 시 밀도가 감소 "
        "(ρ = 2413 - 0.488T)하여 핵종 수밀도가 저하되고, 이에 따라 "
        "거시단면적(특히 νΣ_f)이 감소하여 반응도가 하강한다. "
        "이 효과는 약 -25 ~ -30 pcm/K로 지배적 기여를 한다.",
        "도플러 넓힘(Doppler broadening): 온도 상승에 의한 U-238 공명 "
        "흡수 단면적의 넓힘으로, 공명 자기차폐 효과가 감소하여 "
        "실효 흡수율이 증가한다. 이 효과는 약 -5 ~ -10 pcm/K로 "
        "보조적 기여를 한다.",
        "열중성자 업산란(thermal upscattering): 감속재 온도 상승 시 "
        "열중성자 스펙트럼이 경화(hardening)되어, 열중성자군에서 "
        "고속군으로의 업산란(upscattering) 확률이 증가한다. "
        "경화된 스펙트럼은 U-235 핵분열 단면적이 낮은 에너지 영역에 "
        "해당하므로 반응도가 감소한다.",
    ])

    pdf.subsection_title("10.8.4 개념설계 대비 비교")

    pdf.body_text(
        "MC 온도 반응도 계수와 개념설계(제2장) 결과의 비교:"
    )

    pdf.add_table(
        headers=["해석 방법", "온도 계수 [pcm/K]", "포함된 효과", "비고"],
        rows=[
            ["MC 수송 (등온)", "-40.7 +/- 11.8",
             "밀도 + 도플러 + 스펙트럼", "총 온도 계수"],
            ["개념설계 alpha_fuel", "-8.3",
             "밀도 효과만 (부분)", "연료 온도만 변화"],
            ["개념설계 alpha_graphite", "-7.3",
             "밀도 효과만 (부분)", "흑연 온도만 변화"],
            ["개념설계 alpha_density", "-6.1",
             "연료 밀도만", "열팽창 효과"],
        ],
        col_widths=[40, 35, 45, 45],
        title="표 10.11 온도 반응도 계수 비교"
    )

    pdf.body_text(
        "MC 총 온도 계수(-40.7 pcm/K)는 개념설계의 부분 계수 합 "
        "(약 -22 pcm/K)보다 절대값이 크다. 이 차이의 원인은 "
        "(1) MC 해석이 밀도, 도플러, 스펙트럼 효과를 통합적으로 반영하는 반면, "
        "개념설계에서는 개별 매개변수를 독립적으로 섭동하여 교차효과가 누락, "
        "(2) MC의 2군 구조가 스펙트럼 경화 효과를 명시적으로 포착, "
        "(3) MC의 비균질 기하학이 연료-감속재 경계에서의 온도 의존적 "
        "플럭스 재분배를 반영하기 때문이다."
    )

    # Figure 10.5 - Temperature reactivity coefficient
    if pdf.get_y() > 160:
        pdf.add_page()
    fig_path = _fig_path("mc_temperature_coeff.png")
    if os.path.exists(fig_path):
        pdf.image(fig_path, x=25, w=160)
        pdf.ln(2)
        pdf.set_font("AppleSD", "", 8.5)
        pdf.set_text_color(45, 55, 72)
        pdf.multi_cell(w=165, h=5,
            text="그림 10.5 온도 반응도 계수. 600°C와 700°C에서의 k_eff 계산 결과 및 "
                 "선형 추세선(dk/dT = -41.0 pcm/K)을 나타낸다.",
            align="C")
        pdf.ln(4)
        pdf.set_text_color(45, 55, 72)
    else:
        pdf.add_figure_placeholder("그림 10.5 - 온도 반응도 계수", height=70)

    pdf.add_note(
        "MC 해석에 의한 α_T = -40.7 pcm/K는 강한 음의 온도 반응도 궤환을 "
        "정량적으로 확인하는 결과이다. 이 값은 3.5σ 수준에서 통계적으로 "
        "유의미하며, MSR의 고유안전성을 뒷받침하는 핵심 설계 변수이다. "
        "온도 100°C 상승 시 약 -4,070 pcm의 반응도 감소가 발생하며, "
        "이는 어떠한 양의 반응도 삽입 사고에서도 원자로가 "
        "자기 안정화(self-stabilizing)됨을 의미한다.",
        note_type="info"
    )

    # ===================================================================
    # 10.9 출력 분포
    # ===================================================================
    pdf.section_title("10.9 출력 분포")

    pdf.subsection_title("10.9.1 축방향 출력 분포")

    pdf.body_text(
        "MC 해석에 의한 축방향 출력 분포는 (r,z) 격자 탈리에서 "
        "반경방향 평균을 취하여 산출하였다. 축방향 출력 분포는 "
        "코사인 형태에 가까우나, 상부(출구)보다 하부(입구)에서 "
        "약간 높은 비대칭성을 보인다."
    )

    pdf.body_text(
        "축방향 첨두계수(axial peaking factor):"
    )

    pdf.add_equation(
        "F_z = q_max,z / q_avg,z = 1.70",
        label="(10.15)"
    )

    pdf.body_text(
        "개념설계의 이론적 코사인 분포에서의 축방향 첨두계수 1.54 대비 "
        "약 10% 높다. 이 차이는 MC 해석에서 축방향 반사체에 의한 "
        "경계부 플럭스 증가(reflector peaking) 효과가 반영되었기 때문이다. "
        "반사체 인접부에서 반사된 열중성자에 의한 국소적 출력 증가가 "
        "축방향 양 끝단에서 관찰된다."
    )

    pdf.subsection_title("10.9.2 반경방향 출력 분포")

    pdf.body_text(
        "반경방향 출력 분포는 (r,z) 격자 탈리에서 축방향 평균을 취하여 "
        "산출하였다. 반경방향 분포는 중심부에서 최대이며, "
        "노심 경계부로 갈수록 감소하나, 반사체 인접 영역에서 "
        "플럭스 반등(reflector peaking)이 관찰된다."
    )

    pdf.body_text(
        "반경방향 첨두계수(radial peaking factor):"
    )

    pdf.add_equation(
        "F_r = q_max,r / q_avg,r = 2.30",
        label="(10.16)"
    )

    pdf.body_text(
        "개념설계의 Bessel 함수 분포에서의 반경방향 첨두계수 1.59 대비 "
        "약 45% 높다. 이 현저한 차이의 원인은 다음과 같다."
    )

    pdf.add_numbered_list([
        "비균질 효과: 육각 격자의 명시적 모사에 의해, 연료 채널 내에서의 "
        "국소적 출력 피크가 반영된다. 균질 모델에서는 이 효과가 "
        "체적 평균에 의해 소멸된다.",
        "반사체 플럭스 피킹: 반경방향 반사체에 의한 열중성자 반사가 "
        "노심 경계부의 플럭스를 국소적으로 증가시킨다. "
        "개념설계의 Bessel 함수 모델은 경계에서 플럭스가 0으로 "
        "강하하는 반면, 실제로는 반사체에 의한 유한한 경계 플럭스가 존재한다.",
        "통계적 변동: 800 중성자/세대의 MC 해석에서는 "
        "국소적 탈리의 통계적 변동이 크며, 이는 첨두계수를 "
        "과대평가하는 방향으로 작용할 수 있다.",
    ])

    pdf.subsection_title("10.9.3 총 첨두계수")

    pdf.body_text(
        "총 첨두계수(total peaking factor)는 축방향과 반경방향 "
        "첨두계수의 곱으로 보수적으로 추정한다."
    )

    pdf.add_equation(
        "F_total = F_z x F_r = 1.70 x 2.30 = 3.92",
        label="(10.17)"
    )

    pdf.add_table(
        headers=["첨두계수", "MC 수송", "개념설계", "비율 (MC/개념)"],
        rows=[
            ["축방향 F_z", "1.70", "1.54", "1.10"],
            ["반경방향 F_r", "2.30", "1.59", "1.45"],
            ["총 F_total", "3.92", "2.45", "1.60"],
        ],
        col_widths=[40, 30, 30, 40],
        title="표 10.12 출력 첨두계수 비교"
    )

    pdf.body_text(
        "MC 총 첨두계수 3.92는 개념설계 2.45 대비 약 60% 높다. "
        "이 결과는 열수력 설계(핫채널 해석)에 직접적 영향을 미치며, "
        "핫채널 연료 온도가 개념설계 예측보다 높을 수 있음을 시사한다. "
        "다만, MC 해석의 통계적 변동에 의한 첨두계수 과대평가 가능성과, "
        "용융염의 축방향 혼합(axial mixing)에 의한 실효 첨두계수 "
        "저감 효과를 고려하면, 실제 운전 시의 첨두계수는 "
        "MC 결과와 개념설계 결과의 사이에 위치할 것으로 추정된다."
    )

    pdf.add_note(
        "그림 10.6 (출력 분포 시각화): MC 출력 분포 결과 - (좌) 축방향 출력 분포, "
        "(우) 반경방향 출력 분포. 개념설계의 코사인/베셀 분포(점선)와의 비교 그림은 "
        "향후 연속에너지 MC 해석과 연동하여 추가 예정이다.",
        note_type="info"
    )

    # ===================================================================
    # 10.10 개념설계 대비 비교 분석
    # ===================================================================
    pdf.section_title("10.10 개념설계 대비 비교 분석")

    pdf.subsection_title("10.10.1 해석 방법론 비교")

    pdf.body_text(
        "개념설계(제2장)와 본 MC 수송 해석의 방법론을 체계적으로 비교한다."
    )

    pdf.add_table(
        headers=["비교 항목", "개념설계 (제2장)", "MC 수송 (본 장)"],
        rows=[
            ["해석 방법", "1군 확산 방정식 + 4인자 공식",
             "2군 MC 수송 (출력 반복)"],
            ["에너지 분해능", "1군 (열중성자만)", "2군 (고속 + 열중성자)"],
            ["기하 모델", "균질 원통 (r,z)", "3D 비균질 육각 격자"],
            ["누설 모델", "기하학적 버클링 + 반사체 절감량",
             "반사체 명시적 3D 모사"],
            ["산란 처리", "확산 근사 (P1)", "수송 (아날로그 충돌)"],
            ["통계적 특성", "결정론적 (오차 없음)", "확률적 (1sigma ~1%)"],
            ["반사체 효과", "반사체 절감량 delta (해석적 근사)",
             "반사체를 별도 3D 영역으로 모사"],
            ["비균질 효과", "균질화 (체적 평균)", "연료/감속재 명시적 구분"],
            ["온도 궤환", "개별 매개변수 섭동", "등온 전체 온도 변화"],
            ["계산 비용", "수초", "수분 (배치당)"],
        ],
        col_widths=[35, 65, 75],
        title="표 10.13 해석 방법론 비교"
    )

    pdf.subsection_title("10.10.2 핵심 결과 비교")

    pdf.body_text(
        "주요 핵설계 변수의 비교 결과를 종합한다."
    )

    pdf.add_table(
        headers=["변수", "개념설계", "MC 수송", "차이", "주요 원인"],
        rows=[
            ["k_eff (12%)", "1.146 (4인자)", "1.510 +/- 0.027",
             "+0.364", "반사체, 비균질 효과"],
            ["임계 농축도", "7.35%", "3.70 +/- 0.2%",
             "-3.65%p", "반사체에 의한 누설 저감"],
            ["비누설 확률", "0.698", "0.866",
             "+0.168", "반사체 명시적 모사"],
            ["온도 계수", "-8.3 pcm/K (부분)", "-40.7 +/- 11.8 pcm/K",
             "-32.4", "통합 궤환 효과"],
            ["축방향 첨두", "1.54", "1.70",
             "+0.16", "반사체 피킹"],
            ["반경방향 첨두", "1.59", "2.30",
             "+0.71", "비균질, 반사체 피킹"],
            ["총 첨두", "2.45", "3.92",
             "+1.47", "비균질 + 반사체"],
        ],
        col_widths=[30, 35, 35, 25, 50],
        title="표 10.14 핵심 핵설계 변수 비교"
    )

    pdf.subsection_title("10.10.3 MC 해석의 개선 사항")

    pdf.body_text(
        "MC 수송 해석이 개념설계 대비 개선한 핵심 사항을 정리한다."
    )

    pdf.add_numbered_list([
        "에너지 분해능 향상: 2군 구조에 의해 고속군에서의 U-238 공명 흡수와 "
        "열중성자군에서의 U-235 핵분열을 명시적으로 분리. "
        "이는 중성자 밸런스의 정확도를 크게 향상시킨다.",
        "수송 해법: 확산 근사를 사용하지 않으므로, 연료-감속재 경계 및 "
        "노심-반사체 경계에서의 중성자 각분포를 정확히 처리한다.",
        "비균질 기하학: 연료 채널과 흑연 감속재를 명시적으로 구분하여, "
        "플럭스 depression과 spatial self-shielding 효과를 포착한다.",
        "반사체 효과: 반사체를 별도 3D 영역으로 모사하여 정확한 "
        "누설 확률과 경계부 출력 분포를 산출한다.",
        "통합 온도 궤환: 밀도, 도플러, 스펙트럼 효과가 동시에 반영되어 "
        "물리적으로 일관성 있는 온도 반응도 계수를 산출한다.",
    ])

    # ===================================================================
    # 10.11 해석의 제한사항 및 불확실성
    # ===================================================================
    pdf.section_title("10.11 해석의 제한사항 및 불확실성")

    pdf.subsection_title("10.11.1 에너지 분해능의 한계")

    pdf.body_text(
        "2군 에너지 구조는 1군 대비 현저한 개선이나, 연속에너지(CE) MC 해석 "
        "대비 여전히 에너지 분해능이 제한적이다. 특히 다음의 물리 현상이 "
        "2군 근사에서 정밀하게 반영되지 않는다."
    )

    pdf.add_bullet_list([
        "공명 영역(1 eV ~ 10 keV)의 상세 구조: U-238의 수백 개 공명 피크와 "
        "공명간 간섭(inter-resonance interference)이 단일 고속군에 매몰",
        "열중성자 스펙트럼 형상: 맥스웰-볼츠만 분포의 에너지 의존성이 "
        "단일 열중성자군 평균값으로 대체",
        "흑연 S(alpha,beta) 열산란: 결정격자 산란의 에너지 의존 구조가 "
        "군평균 산란 단면적으로 근사",
        "에피열(epithermal) 영역의 상세 감속 스펙트럼: 1/E 감속 스펙트럼의 "
        "핵종 의존 변형이 고속군 단일 값으로 근사",
    ])

    pdf.subsection_title("10.11.2 단면적 불확실성")

    pdf.body_text(
        "본 해석에서 사용한 2군 거시단면적은 ENDF/B-VIII.0 미시단면적에 "
        "기반하되, NJOY/GROUPR에 의한 정밀 군정수 생성이 아닌 "
        "수동 보정(hand calibration)에 의해 산출되었다. 이에 따른 불확실성 요인은 "
        "다음과 같다."
    )

    pdf.add_bullet_list([
        "군평균 방법: 정밀한 가중 스펙트럼(weighting spectrum)에 의한 "
        "군축약이 아닌 대표 스펙트럼에 의한 근사적 군평균",
        "S(alpha,beta) 미처리: 흑연의 열중성자 산란에 대한 "
        "결정격자 산란 법칙(thermal scattering law)이 적용되지 않음",
        "공명 자기차폐 근사: 군평균 과정에서의 공명 자기차폐 처리가 "
        "연속에너지 코드 대비 부정확할 수 있음",
        "벤치마크 부재: 본 코드의 결과를 검증할 수 있는 직접적 "
        "실험 데이터 또는 참조 계산이 제한적",
    ])

    pdf.subsection_title("10.11.3 통계적 불확실성")

    pdf.body_text(
        "MC 해석의 통계적 불확실성은 소스 중성자 수와 세대 수에 의해 결정된다. "
        "본 해석에서 사용한 800 중성자/세대 × 250 활성 세대는 "
        "상용 MC 코드의 전형적 설정(10,000~100,000 중성자/세대) 대비 "
        "현저히 적으며, 이에 따른 통계적 불확실도가 크다."
    )

    pdf.add_table(
        headers=["결과 변수", "통계 불확실도 (1sigma)", "상대 불확실도"],
        rows=[
            ["k_eff", "+/- 0.016 ~ 0.027", "~1 ~ 2%"],
            ["온도 계수", "+/- 11.8 pcm/K", "~29%"],
            ["국소 출력 (탈리 셀)", "+/- 5 ~ 15%", "5 ~ 15%"],
            ["누설 확률", "+/- 1 ~ 3%", "8 ~ 22%"],
        ],
        col_widths=[50, 55, 50],
        title="표 10.15 MC 통계적 불확실도 요약"
    )

    pdf.body_text(
        "k_eff의 통계적 불확실도 ~1-2%는 노심 핵설계의 주요 경향 파악에는 "
        "충분하나, 정밀한 반응도 관리(수십 pcm 수준)에는 부적합하다. "
        "온도 반응도 계수의 상대 불확실도 ~29%는 부호(음의 값) 확인과 "
        "크기의 대략적 범위 파악에는 유용하나, 정량적 설계 기준으로는 "
        "불충분하며, 소스 중성자 수를 10배 이상 증가시킬 필요가 있다."
    )

    pdf.subsection_title("10.11.4 기타 제한사항")

    pdf.body_text(
        "추가적인 해석 제한사항은 다음과 같다."
    )

    pdf.add_bullet_list([
        "연소도 미결합: 본 해석은 수명 초기(BOL, fresh fuel) 상태의 "
        "정적 해석이며, 연소에 따른 핵종 조성 변화(U-235 소진, Pu 생성, "
        "FP 축적)가 반영되지 않음. 연소도 결합 해석은 별도 수행 필요",
        "아날로그 수송: 분산 감소 기법(variance reduction, 예: "
        "implicit capture, weight window) 미적용. 이로 인해 동일 계산 시간 "
        "대비 통계적 정밀도가 비아날로그 방법보다 낮음",
        "등방 산란 가정: 실제 중성자 산란은 비등방(anisotropic)이나, "
        "본 코드에서는 등방 산란을 가정. 특히 고속군에서의 전방 산란 "
        "경향이 반영되지 않아 감속 길이(slowing-down length)에 영향",
        "지연중성자 미포함: MC k-고유값 해석에서 즉발중성자(prompt neutron)만 "
        "추적하며, 지연중성자의 에너지 스펙트럼 차이는 반영되지 않음. "
        "이는 k_eff에 수십 pcm 수준의 영향을 줄 수 있음",
    ])

    pdf.add_note(
        "본 MC 수송 해석은 개념설계의 1군 확산 해석을 크게 개선하였으나, "
        "연속에너지 MC 코드(Serpent-2, OpenMC, MCNP6)에 의한 "
        "고충실도(high-fidelity) 검증이 필수적이다. 특히 임계 농축도, "
        "온도 반응도 계수, 출력 분포의 정량적 확정을 위해서는 "
        "검증된 핵데이터 라이브러리(ENDF/B-VIII.0 ACE 형식)와 "
        "S(alpha,beta) 열산란 법칙을 적용한 연속에너지 MC 해석이 "
        "기본설계 이후 단계에서 반드시 수행되어야 한다.",
        note_type="warning"
    )

    # ===================================================================
    # 10.12 향후 설계 단계 제안
    # ===================================================================
    pdf.section_title("10.12 향후 설계 단계 제안")

    pdf.subsection_title("10.12.1 농축도 최적화")

    pdf.body_text(
        "MC 해석에 의한 임계 농축도 3.70%는 설계 농축도 12%가 "
        "과도하게 높음을 확인시켜 준다. 향후 설계에서는 "
        "목표 연소도(target burnup)와 수명 기간 반응도 손실을 "
        "고려하여 적정 농축도를 5-7% 범위에서 최적화할 것을 제안한다."
    )

    pdf.add_bullet_list([
        "LEU(<5%) 설계 가능성: 임계 농축도 3.70%로부터 연소도 "
        "반응도 손실과 운전 여유를 합산하면, 4.5-5.0% 농축도로 "
        "충분한 수명(~2년)을 확보할 수 있을 것으로 예상",
        "HALEU(5-10%) 설계: 장기 수명(5-10년)과 온라인 연료 처리 없이 "
        "연속 운전을 위해서는 5-7% 농축도가 적절할 것으로 추정",
        "초기 과잉 반응도 예산: 목표 농축도에서의 BOL 과잉 반응도를 "
        "연소 손실, FP 독물질, 온도 궤환, 제어 시스템 가치 등으로 "
        "체계적으로 배분하는 반응도 예산(reactivity budget) 수립 필요",
    ])

    pdf.subsection_title("10.12.2 제어 시스템 설계")

    pdf.body_text(
        "12% 농축도에서의 과잉 반응도 33,800 pcm(또는 최적화된 농축도에서도 "
        "수천 pcm)을 안전하게 관리하기 위한 제어 시스템 설계가 필수적이다."
    )

    pdf.add_bullet_list([
        "제어봉 시스템: 흑연 반사체 내 또는 노심 상부에 B₄C 또는 Gd₂O₃ "
        "제어봉 삽입 설계. 제어봉 가치(control rod worth) 평가를 위한 "
        "MC 섭동 해석 필요",
        "가용성 중성자 흡수재(burnable absorber): 연료염에 첨가 가능한 "
        "Er₂O₃ 또는 Gd₂O₃ 등의 가용성 독물질 검토. "
        "BOL 과잉 반응도를 자기 소진(self-depletion)으로 보상",
        "농축도 조절: 온라인 연료 처리에 의한 U-235 농도의 "
        "연속적 조절 가능성 검토",
    ])

    pdf.subsection_title("10.12.3 고충실도 검증 해석")

    pdf.body_text(
        "본 2군 MC 해석 결과의 정량적 신뢰성 확보를 위해, "
        "다음의 고충실도 검증 해석을 제안한다."
    )

    pdf.add_numbered_list([
        "Serpent-2 연속에너지 MC 해석: ENDF/B-VIII.0 ACE 형식 핵데이터와 "
        "graphite.10t S(alpha,beta) 열산란 법칙을 적용한 연속에너지 "
        "MC 임계도 해석. k_eff, 반응도 계수, 출력 분포의 정밀 산출.",
        "OpenMC 해석: 오픈소스 MC 코드에 의한 독립적 교차 검증. "
        "특히 비균질 육각 격자 모델과 반사체 효과의 검증에 유용.",
        "Griffin/MOOSE 다군 결정론적 해석: MOOSE 프레임워크의 "
        "Griffin 모듈에 의한 다군(6-20군) 결정론적 수송 해석. "
        "MC 대비 노이즈 없는 공간 분포 산출 가능.",
        "MCNP6 차폐/선원 해석: 출력 분포 결과를 MCNP6에 입력하여 "
        "차폐 설계(제7장)의 선원항 정밀화에 활용.",
    ])

    pdf.subsection_title("10.12.4 연소/소손 결합 해석")

    pdf.body_text(
        "수명 기간 동안의 핵종 조성 변화를 추적하는 연소/소손(depletion) "
        "결합 해석이 필요하다. 이를 통해 다음의 설계 정보를 산출할 수 있다."
    )

    pdf.add_bullet_list([
        "수명 기간 k_eff 변화 곡선(burnup-dependent reactivity swing)",
        "핵분열 생성물(Xe-135, Sm-149 등) 독물질의 정상상태 반응도 손실",
        "Pu-239 등 초우라늄 핵종의 생성 및 반응도 기여",
        "연료 장입 수명(cycle length) 및 재장입(refueling) 주기 결정",
        "배출 연소도(discharge burnup) 및 핵분열 생성물 인벤토리",
    ])

    pdf.subsection_title("10.12.5 핫채널 해석 정밀화")

    pdf.body_text(
        "MC 해석에 의한 총 첨두계수 3.92는 개념설계(2.45) 대비 "
        "약 60% 높으며, 이는 열수력 설계에 직접적 영향을 미친다. "
        "MC 출력 분포를 열수력 해석(제3장)의 입력으로 활용하여 "
        "핫채널 온도를 재평가할 것을 제안한다."
    )

    pdf.add_bullet_list([
        "MC 출력 분포 기반 핫채널 열수력 재해석: (r,z) 출력 분포를 "
        "단일 채널 열수력 모델에 입력하여 핫채널 연료 최고 온도 재평가",
        "핫채널 인자 갱신: MC 첨두계수에 기반한 핵적 핫채널 인자(F_q) 갱신",
        "열적 여유도 재평가: 갱신된 핫채널 온도와 비등점(1,400°C) 간의 "
        "열적 여유도(thermal margin) 재확인",
        "출력 분포 평탄화: 필요 시 농축도 구배(enrichment zoning) 또는 "
        "가용성 독물질에 의한 출력 분포 평탄화 방안 검토",
    ])

    pdf.body_text(
        "종합적으로, 본 장의 MC 수송 해석은 개념설계의 1군 확산 해석을 "
        "2군 수송 수준으로 고도화하여, 노심 핵설계의 주요 변수를 재평가하였다. "
        "MC 해석에 의한 임계 농축도(3.70%), 강한 음의 온도 계수(-40.7 pcm/K), "
        "높은 출력 첨두계수(3.92) 등의 결과는 설계의 방향성을 "
        "정량적으로 제시하며, 향후 Serpent-2/OpenMC 등 연속에너지 MC 코드에 "
        "의한 고충실도 검증과 연소 결합 해석으로의 발전이 필요하다."
    )
