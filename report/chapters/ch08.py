"""
Chapter 8: 선박 통합 (Ship Integration)
=========================================

40 MWth 해양용 용융염 원자로의 선박 통합 설계를 다룬다.
대상 선박 사양, 추진 동력 요건, 원자로 계통 배치, 중량 분석,
동력변환 계통(sCO2 Brayton), 전기/보조 계통, 기관실 배치를 포함한다.

write_chapter(pdf) 함수는 MSRReport 인스턴스를 받아
Chapter 8 내용을 PDF에 기록한다.
"""


def write_chapter(pdf):
    """Write Chapter 8: 선박 통합."""

    pdf.chapter_title(8, "선박 통합")

    pdf.body_text(
        "본 장에서는 40 MWth 해양용 용융염 원자로를 6,000 TEU 파나막스급 컨테이너선에 "
        "통합하기 위한 설계 분석을 수행한다. 원자로 계통의 물리적 배치, 중량 및 공간 "
        "적합성, 초임계 CO₂ 브레이턴 동력변환 계통, 전기 추진 시스템, 보조 계통 등을 "
        "종합적으로 검토하여 해양 원자력 추진의 기술적 타당성을 평가한다."
    )

    # ===================================================================
    # 8.1 대상 선박
    # ===================================================================
    pdf.section_title("8.1 대상 선박")

    pdf.body_text(
        "설계 대상 선박은 세계 주요 항로에서 운용되는 6,000 TEU급 파나막스 "
        "컨테이너선이다. 파나막스급은 파나마 운하 통과가 가능한 최대 선형으로, "
        "국제 해운에서 중간 규모의 주력 선종을 대표한다."
    )

    pdf.add_table(
        headers=["항목", "사양", "비고"],
        rows=[
            ["선종", "컨테이너선", "6,000 TEU급"],
            ["선급", "파나막스 (Panamax)", "파나마 운하 통과"],
            ["전장 (LOA)", "294 m", "-"],
            ["수선간장 (LBP)", "280 m", "-"],
            ["형폭 (Beam)", "32.3 m", "Panamax 최대"],
            ["형깊이 (Depth)", "21.5 m", "-"],
            ["만재 흘수", "13.0 m", "-"],
            ["배수량 (만재)", "80,000 톤", "근사값"],
            ["재화중량 (DWT)", "55,000 톤", "-"],
            ["설계 속력", "18 노트", "서비스 속력"],
            ["최대 속력", "22 노트", "-"],
            ["기관실 길이", "25 m", "-"],
            ["기관실 폭", "20 m", "선체 내측"],
            ["기관실 높이", "12 m", "이중저~갑판"],
        ],
        col_widths=[40, 45, 80],
        title="표 8.1 대상 선박 주요 사양"
    )

    pdf.subsection_title("8.1.1 기존 추진 사양")

    pdf.body_text(
        "동급 기존 컨테이너선은 대형 2행정 디젤 엔진(예: MAN B&W 7S70ME-C)을 "
        "주기관으로 사용하며, 주요 사양은 다음과 같다:"
    )

    pdf.add_bullet_list([
        "주기관 출력: 약 27,000 kW (MCR)",
        "연료 소모량: 약 130 톤/일 (HFO, 서비스 속력)",
        "연료 적재량: 약 5,200 톤 (40일 항속)",
        "연간 연료 소모: 약 36,000 톤 (항해일 280일 기준)",
        "CO₂ 배출: 약 112,000 톤/년 (CO₂ 환산계수 3.11)",
        "20년 연료비: 약 2.5~3.5억 USD (유가 변동에 따라)",
    ])

    pdf.subsection_title("8.1.2 원자력 대체 이점")

    pdf.body_text(
        "원자력 추진으로 대체 시 다음과 같은 이점이 기대된다:"
    )

    pdf.add_numbered_list([
        "연료비 절감: 20년 운항 기간 동안 화석연료 비용 완전 절감. 핵연료비는 "
        "전체 발전단가의 약 10% 수준으로 경제적 우위",
        "무탄소 운항: CO₂ 배출 완전 제거 (연간 ~112,000톤 절감). "
        "SOx, NOx, PM 등 대기오염물질도 배출 없음",
        "화물 적재량 증가: 연료 탱크(~5,200톤 공간) 제거로 화물 적재 공간 확보",
        "항속거리 무제한: 연료 보급 없이 장기 운항 가능, 항로 유연성 극대화",
        "연료 가격 변동 위험 제거: 유가 변동에 영향받지 않는 안정적 운항 비용",
    ])

    # ===================================================================
    # 8.2 추진 동력 요건
    # ===================================================================
    pdf.section_title("8.2 추진 동력 요건")

    pdf.subsection_title("8.2.1 선체 저항 추정")

    pdf.body_text(
        "서비스 속력 18노트(약 9.26 m/s)에서의 선체 저항을 Holtrop-Mennen 방법으로 "
        "추정한다. 파나막스 컨테이너선의 전저항은 마찰저항, 조파저항, 부가저항(해상 "
        "상태, 오탁 등)의 합으로 구성된다."
    )

    pdf.add_equation(
        "R_T = R_f + R_w + R_app + R_sea",
        label="(8.1)"
    )

    pdf.body_text(
        "서비스 속력 18노트에서의 추정 전저항은 약 900 kN이며, 필요 유효출력은:"
    )

    pdf.add_equation(
        "P_E = R_T x V_s = 900 x 10³ x 9.26 = 8,334 kW",
        label="(8.2)"
    )

    pdf.body_text(
        "프로펠러 효율(eta_p ~ 0.65), 전달 효율(eta_t ~ 0.98)을 고려한 "
        "축 출력(shaft power)은:"
    )

    pdf.add_equation(
        "P_shaft = P_E / (eta_p x eta_t) = 8,334 / (0.65 x 0.98) = 13,085 kW ~ 14 MW",
        label="(8.3)"
    )

    pdf.subsection_title("8.2.2 동력 배분")

    pdf.body_text(
        "원자로 열출력 40 MWth에서 동력변환 효율 40%를 적용하면 전기출력 약 16 MWe가 "
        "발생하며, 이를 추진과 호텔 부하로 배분한다."
    )

    pdf.add_table(
        headers=["항목", "출력 [MW]", "비율", "비고"],
        rows=[
            ["원자로 열출력", "40.0", "100%", "핵분열 열"],
            ["동력변환 효율", "-", "40%", "sCO₂ Brayton"],
            ["총 전기출력", "16.0", "-", "발전기 출력"],
            ["추진 동력", "14.0", "87.5%", "축 출력"],
            ["호텔 부하", "1.5", "9.4%", "조명, 냉난방, 항해장비"],
            ["보조기기", "0.5", "3.1%", "펌프, 팬, 제어계통"],
        ],
        col_widths=[40, 25, 20, 80],
        title="표 8.2 동력 배분"
    )

    pdf.subsection_title("8.2.3 속력-동력 관계")

    pdf.body_text(
        "선박의 저항은 속력의 약 2승, 필요 동력은 속력의 약 3승에 비례한다. "
        "이 관계를 이용하면 다양한 운항 조건에서의 가용 속력을 추정할 수 있다."
    )

    pdf.add_table(
        headers=["속력 [knots]", "필요 축출력 [MW]", "여유출력 [MW]", "비고"],
        rows=[
            ["14", "5.6", "8.4", "서행 운항"],
            ["16", "8.3", "5.7", "경제 속력"],
            ["18", "14.0", "0.0", "서비스 속력 (설계점)"],
            ["20", "21.0", "-7.0", "출력 부족 (불가)"],
        ],
        col_widths=[30, 35, 30, 70],
        title="표 8.3 속력별 필요 출력"
    )

    pdf.body_text(
        "40 MWth 원자로(축출력 ~14 MW)로 설계 속력 18노트를 확보할 수 있으며, "
        "경제 속력 16노트에서는 약 40%의 여유 출력이 있어 악천후 시에도 속력 "
        "유지가 가능하다. 20노트 이상의 고속은 추가 동력원 없이는 도달 불가하다."
    )

    # ===================================================================
    # 8.3 원자로 계통 배치
    # ===================================================================
    pdf.section_title("8.3 원자로 계통 배치")

    pdf.body_text(
        "원자로 계통은 원자로 용기, 1차 열교환기, 1차 펌프, 차폐 구조물, "
        "중간루프 계통으로 구성된다. 각 구성품의 치수와 질량은 이전 장들의 "
        "설계 결과에 기반한다."
    )

    pdf.add_table(
        headers=["구성품", "치수 (직경 x 높이)", "질량 [톤]", "비고"],
        rows=[
            ["원자로 용기", "1.6 m OD x 2.6 m", "~4.5", "Hastelloy-N"],
            ["반사체/다운커머", "+0.3 m 반경", "~2.8", "흑연+간극"],
            ["1차 열교환기", "0.6 m x 3.5 m", "~5.2", "Shell-tube"],
            ["1차 펌프", "0.8 m x 1.2 m", "~1.8", "원심 펌프"],
            ["연료염 재고량", "-", "~3.2", "노심+배관"],
            ["흑연 감속재", "-", "~2.4", "IG-110"],
            ["배관/밸브", "-", "~2.0", "Hastelloy-N"],
            ["차폐 구조물", "5.0 m OD x 5.8 m H", "~250", "4층 차폐"],
            ["기초 구조물", "-", "~15", "강재 지지대"],
            ["중간루프 HX", "0.5 m x 3.0 m", "~3.5", "2차→3차"],
            ["중간루프 펌프", "0.6 m x 0.8 m", "~1.2", "-"],
            ["계측/제어 장치", "-", "~2.0", "-"],
        ],
        col_widths=[35, 40, 25, 65],
        title="표 8.4 원자로 계통 구성품 목록"
    )

    pdf.subsection_title("8.3.1 차폐 구조물 상세")

    pdf.body_text(
        "차폐 구조물은 원자로 용기를 동심원상으로 둘러싸는 원통형 구조이며, "
        "제7장에서 설계된 4층 차폐(총 162 cm)가 적용된다. 차폐 외경은 약 5.0 m, "
        "높이는 약 5.8 m(노심 높이 + 상하부 플레넘 + 차폐 여유)이다. "
        "차폐 구조물 상부에는 연료 장전/보수를 위한 개폐식 상부 차폐 플러그가 "
        "설치되며, 1차 배관 관통부에는 추가 차폐 슬리브가 적용된다."
    )

    pdf.subsection_title("8.3.2 배치 개념")

    pdf.body_text(
        "원자로 계통의 배치는 다음 원칙에 따른다:"
    )

    pdf.add_numbered_list([
        "원자로 용기, 1차 열교환기, 1차 펌프를 차폐 구조물 내부에 일체화하여 "
        "방사화 구역을 최소화",
        "중간루프 계통은 차폐 외부에 배치하여 비방사화 구역으로 분리",
        "비상 배수 탱크(drain tank)를 원자로 하부에 배치하여 중력 배수 보장",
        "중심선 배치로 선체 횡동요에 의한 비대칭 하중 최소화",
        "기초 구조물은 선체 이중저 강재와 직접 연결하여 하중 전달",
    ])

    # ===================================================================
    # 8.4 중량 분석
    # ===================================================================
    pdf.section_title("8.4 중량 분석")

    pdf.subsection_title("8.4.1 구성품별 중량 적산")

    pdf.add_table(
        headers=["항목", "중량 [톤]", "비율", "비고"],
        rows=[
            ["원자로 용기", "4.5", "1.2%", "Hastelloy-N"],
            ["연료염", "3.2", "0.8%", "노심+배관"],
            ["흑연 감속재", "2.4", "0.6%", "IG-110"],
            ["1차 열교환기", "5.2", "1.3%", "Shell-tube"],
            ["1차 펌프", "1.8", "0.5%", "-"],
            ["배관/밸브/계측", "4.0", "1.0%", "-"],
            ["차폐 구조물", "250", "64.8%", "4층 차폐"],
            ["기초 구조물", "15", "3.9%", "강재"],
            ["중간루프 계통", "8.0", "2.1%", "HX+펌프+배관"],
            ["동력변환 (sCO₂)", "50", "13.0%", "터빈+압축기"],
            ["발전기", "18", "4.7%", "16 MWe"],
            ["보조 계통", "12", "3.1%", "냉각, 환기 등"],
            ["여유 (10%)", "12", "3.1%", "설계 여유"],
            ["합계", "~386", "100%", "-"],
        ],
        col_widths=[35, 25, 20, 85],
        title="표 8.5 원자로 시스템 중량 적산"
    )

    pdf.body_text(
        "원자로 시스템 총 중량은 약 386톤으로, 이중 차폐 구조물이 약 250톤(65%)으로 "
        "지배적이다. 동력변환 계통(sCO₂ 터빈/압축기, 발전기)이 약 68톤(18%)으로 "
        "그 다음을 차지한다."
    )

    pdf.subsection_title("8.4.2 기존 디젤 시스템 비교")

    pdf.add_table(
        headers=["항목", "디젤 추진 [톤]", "원자력 추진 [톤]", "차이 [톤]"],
        rows=[
            ["주기관", "300", "-", "-300"],
            ["연료유 (만재)", "5,200", "-", "-5,200"],
            ["연료 탱크 구조", "200", "-", "-200"],
            ["배기 시스템", "50", "-", "-50"],
            ["원자로 시스템", "-", "386", "+386"],
            ["합계", "5,750", "386", "-5,364"],
        ],
        col_widths=[40, 35, 35, 55],
        title="표 8.6 기존 디젤 vs 원자력 추진 중량 비교"
    )

    pdf.body_text(
        "원자력 추진 시스템(386톤)은 기존 디젤 시스템(주기관 + 만재 연료 5,750톤)에 "
        "비해 약 5,364톤이 가볍다. 이 중량 절감의 대부분은 연료유 불필요에 기인하며, "
        "절감된 중량만큼 추가 화물 적재가 가능하다."
    )

    pdf.subsection_title("8.4.3 20년 운항 연료 절감")

    pdf.body_text(
        "20년 설계 수명 동안의 연료 관련 경제성을 분석하면:"
    )

    pdf.add_bullet_list([
        "연간 항해일: 280일 (용량계수 85% 적용 시 약 310일)",
        "연간 연료 소모: ~36,000 톤 HFO",
        "20년 총 연료 소모: ~720,000 톤 HFO",
        "연료 단가 (HFO): 약 400~600 USD/톤 (2024년 기준)",
        "20년 연료비: 약 2.9~4.3억 USD",
        "핵연료비 (20년): 약 0.3~0.5억 USD (전체의 ~10%)",
        "순 연료비 절감: 약 2.4~3.8억 USD",
    ])

    # ===================================================================
    # 8.5 공간 적합성
    # ===================================================================
    pdf.section_title("8.5 공간 적합성")

    pdf.body_text(
        "기관실의 치수(25 m x 20 m x 12 m, 체적 6,000 m³)에 대한 원자로 시스템의 "
        "공간 점유율을 평가한다."
    )

    pdf.subsection_title("8.5.1 점유 비율 분석")

    pdf.add_table(
        headers=["항목", "바닥 면적 [m²]", "체적 [m³]", "기관실 대비"],
        rows=[
            ["차폐 구조물 (설치면)", "~20 (5m x 5m)", "~114", "1.9%"],
            ["동력변환 계통", "~24 (6m x 4m)", "~72", "1.2%"],
            ["중간루프 계통", "~12 (4m x 3m)", "~36", "0.6%"],
            ["전기 계통", "~16 (4m x 4m)", "~48", "0.8%"],
            ["보조 계통", "~10 (5m x 2m)", "~30", "0.5%"],
            ["합계", "~82", "~300", "5.0%"],
            ["기관실 전체", "500", "6,000", "100%"],
        ],
        col_widths=[40, 30, 25, 70],
        title="표 8.7 기관실 공간 점유율"
    )

    pdf.body_text(
        "원자로 시스템의 총 체적 점유율은 기관실의 약 5.0%에 불과하다. "
        "이는 기존 디젤 엔진 시스템(기관 본체, 연료 탱크, 배기 시스템 등으로 "
        "기관실의 약 40~50%를 점유)에 비해 현저히 작다. "
        "sCO₂ 브레이턴 사이클의 컴팩트한 특성이 공간 절약에 크게 기여한다."
    )

    pdf.subsection_title("8.5.2 정비 접근 및 크레인/해치")

    pdf.body_text(
        "원자로 시스템의 정비 접근성을 확보하기 위해 다음 사항을 고려한다:"
    )

    pdf.add_bullet_list([
        "차폐 구조물 주위에 최소 1.5 m의 정비 접근 공간 확보",
        "상부 차폐 플러그 제거를 위한 기관실 해치(hatch) 설치 "
        "(최소 5.5 m x 5.5 m 개구부)",
        "기관실 천장 크레인: 용량 50톤 이상 (차폐 플러그 중량 기준)",
        "동력변환 계통 구성품(터빈, 압축기)의 반입/반출 경로 확보",
        "비상 접근 경로: 원자로 구획에서 2방향 이상의 탈출 통로",
    ])

    # ===================================================================
    # 8.6 선박 운동 하중
    # ===================================================================
    pdf.section_title("8.6 선박 운동 하중")

    pdf.body_text(
        "제5장에서 DNV GL 규칙에 따라 상세 해석한 3개 하중경우의 결과를 요약한다. "
        "원자로 지지 구조물 설계를 위한 설계 하중 포락선을 제시한다."
    )

    pdf.add_table(
        headers=["하중경우", "횡가속도 [g]", "종가속도 [g]", "수직가속도 [g]",
                 "합성 [g]", "지배 하중"],
        rows=[
            ["LC1: 해상 (횡동요+상하동요)", "0.68", "0.17", "0.50",
             "0.87", "횡방향"],
            ["LC2: 항내 지진 (0.2g)", "0.20", "-", "0.13",
             "0.24", "수평"],
            ["LC3: 충돌 (1g)", "-", "1.00", "-",
             "1.00", "종방향"],
            ["설계 포락선", "0.68", "1.00", "1.50", "-", "포락"],
        ],
        col_widths=[40, 22, 22, 25, 17, 29],
        title="표 8.8 DNV GL 하중경우 요약"
    )

    pdf.body_text(
        "주요 결론:"
    )

    pdf.add_bullet_list([
        "해상 상태(LC1)에서 횡방향 가속도(0.68g)가 가장 크며, 이는 30도 횡동요 "
        "및 원심 효과에 기인",
        "충돌 하중(LC3, 1g 종방향)이 개별 축 기준 최대 가속도",
        "수직 방향은 자중(1g) + 상하동요(0.5g) = 1.5g가 설계 하중",
        "기초 볼트: 12개 SA-193 B7, 안전율 3.0 이상 확보",
        "자유 표면 효과(GG'): 0.003 mm로 무시 가능 (밀봉 용기)",
    ])

    # ===================================================================
    # 8.7 동력변환 계통
    # ===================================================================
    pdf.section_title("8.7 동력변환 계통")

    pdf.body_text(
        "동력변환 계통은 원자로의 열에너지를 전기 에너지로 변환하는 핵심 시스템이다. "
        "본 설계에서는 초임계 CO₂(sCO₂) 브레이턴 사이클을 채택하였다."
    )

    pdf.subsection_title("8.7.1 sCO₂ 브레이턴 사이클 개요")

    pdf.body_text(
        "초임계 CO₂는 임계점(31.1도C, 7.38 MPa) 이상에서 기체와 액체의 구분이 "
        "사라지는 초임계 유체 상태로 운용되며, 높은 밀도(기체의 수백 배)와 "
        "양호한 수송 물성을 동시에 가진다. sCO₂ 사이클은 증기 랭킨 사이클 대비 "
        "다음과 같은 장점을 가진다:"
    )

    pdf.add_bullet_list([
        "고효율: 500~700도C 열원에서 40~50%의 열효율 달성 가능",
        "컴팩트: 터보기계(터빈, 압축기)의 체적이 증기 터빈의 약 1/10",
        "빠른 기동: 작동 유체의 열관성이 낮아 부하 추종 시간 수 분 이내",
        "단순 구조: 상변화 없이 단일 상태로 운전, 응축기 불필요",
        "비독성/비가연성: CO₂는 안전한 작동 유체",
    ])

    pdf.subsection_title("8.7.2 사이클 구성")

    pdf.body_text(
        "본 설계에서 채택한 재압축(recompression) 브레이턴 사이클의 구성은 다음과 같다:"
    )

    pdf.add_numbered_list([
        "주 압축기 (Main Compressor): 임계점 근처(32도C, 7.7 MPa)에서 sCO₂를 고압(25 MPa)으로 가압",
        "재압축기 (Recompressor): 전체 유량의 약 40%를 별도로 재압축하여 사이클 효율 향상",
        "저온 회복기 (LTR): 터빈 출구 저압 고온 sCO₂와 압축기 출구 고압 저온 sCO₂ 간 열교환",
        "고온 회복기 (HTR): LTR과 유사하나 고온부에서 추가 열회수",
        "중간루프 열교환기: FLiNaK 중간염으로부터 sCO₂로 열전달 (620도C 터빈 입구 온도 확보)",
        "터빈: 고온 고압(620도C, 25 MPa)의 sCO₂가 팽창하면서 일을 수행",
        "전냉각기 (Precooler): 해수로 sCO₂를 냉각하여 압축기 입구 조건(32도C) 달성",
    ])

    pdf.subsection_title("8.7.3 T-s 선도 설명")

    pdf.body_text(
        "재압축 sCO₂ 브레이턴 사이클의 T-s 선도 상 주요 상태점은 다음과 같다. "
        "모든 과정은 초임계 영역에서 진행되므로 상변화가 없다."
    )

    pdf.add_table(
        headers=["상태점", "과정", "온도 [도C]", "압력 [MPa]", "비고"],
        rows=[
            ["1", "압축기 입구", "32", "7.7", "임계점 근방"],
            ["2", "압축기 출구", "75", "25.0", "주 압축"],
            ["3", "HTR 출구 (냉측)", "350", "25.0", "열회수"],
            ["4", "열원 HX 출구", "620", "25.0", "터빈 입구"],
            ["5", "터빈 출구", "410", "7.7", "팽창 후"],
            ["6", "HTR 출구 (온측)", "165", "7.7", "열회수"],
            ["7", "전냉각기 입구", "80", "7.7", "해수 냉각 전"],
        ],
        col_widths=[20, 35, 25, 25, 60],
        title="표 8.9 sCO₂ 사이클 상태점"
    )

    pdf.subsection_title("8.7.4 주요 구성품 사양")

    pdf.add_table(
        headers=["구성품", "사양", "비고"],
        rows=[
            ["터빈", "16.5 MWe, 620도C/25 MPa 입구", "축류식, 단일축"],
            ["주 압축기", "6.2 MW, 32도C/7.7 MPa 입구", "원심식"],
            ["재압축기", "4.3 MW, 80도C/7.7 MPa 입구", "원심식"],
            ["고온 회복기", "PCHE, ~15 m² NTU ~4", "인쇄회로형 HX"],
            ["저온 회복기", "PCHE, ~12 m² NTU ~3", "인쇄회로형 HX"],
            ["전냉각기", "Shell-plate, 해수 냉각", "Ti 합금 관재"],
            ["작동 유체", "CO₂, 99.9% 이상", "~800 kg 재고"],
        ],
        col_widths=[35, 55, 75],
        title="표 8.10 sCO₂ 동력변환 계통 사양"
    )

    pdf.body_text(
        "사이클 열효율은 약 40%이며, 터빈 출력 16.5 MWe에서 압축기 소요 동력 "
        "(주 압축기 6.2 MW + 재압축기 4.3 MW = 10.5 MW)을 차감하면 순 전기출력 "
        "약 16 MWe가 확보된다. 나머지 ~0.5 MW는 보조기기 구동 손실이다."
    )

    pdf.subsection_title("8.7.5 해양 적용 이점")

    pdf.body_text(
        "sCO₂ 브레이턴 사이클은 해양 원자로에 특히 적합한 동력변환 방식이다:"
    )

    pdf.add_bullet_list([
        "컴팩트 터보기계: 터빈 직경 ~0.5 m, 길이 ~1.5 m로 기관실 공간 제약 만족",
        "무수(waterless) 사이클: 담수 생산 부담 없음 (증기 터빈은 급수 처리 필요)",
        "해수 냉각 직접 활용: 전냉각기에서 해수로 직접 방열, 냉각탑 불필요",
        "빠른 부하 추종: 수 분 이내 부하 변동 가능, 항해 조건 변화에 신속 대응",
        "고효율 부분부하: 50% 부분부하에서도 35% 이상 효율 유지",
        "진동/충격 내성: 작은 회전체 질량, 높은 고유진동수 → 선박 운동에 강건",
    ])

    # ===================================================================
    # 8.8 전기 계통
    # ===================================================================
    pdf.section_title("8.8 전기 계통")

    pdf.subsection_title("8.8.1 발전기 사양")

    pdf.body_text(
        "sCO₂ 터빈에 직결된 동기 발전기가 전력을 생산한다."
    )

    pdf.add_table(
        headers=["항목", "사양"],
        rows=[
            ["형식", "동기 발전기 (영구자석형)"],
            ["정격 출력", "16 MVA / 16 MWe (역률 1.0)"],
            ["전압", "6.6 kV, 3상 60 Hz"],
            ["회전수", "3,600 rpm (2극)"],
            ["효율", "97%"],
            ["냉각", "공냉 (강제통풍)"],
            ["중량", "~18 톤"],
        ],
        col_widths=[40, 125],
        title="표 8.11 발전기 사양"
    )

    pdf.subsection_title("8.8.2 배전 계통")

    pdf.body_text(
        "전기 추진 선박의 배전 계통은 다음과 같이 구성된다:"
    )

    pdf.add_bullet_list([
        "주 배전반: 6.6 kV, 3상, 60 Hz",
        "변압기: 6.6 kV / 440 V (선내 배전용), 6.6 kV / 690 V (추진 모터용)",
        "추진 변환기: 가변주파수 구동(VFD)에 의한 추진 모터 제어",
        "무정전 전원(UPS): 핵계측/제어계통 전원 보장 (배터리 30분 용량)",
    ])

    pdf.subsection_title("8.8.3 추진 모터")

    pdf.body_text(
        "전기 추진 방식을 채택하여, 발전기에서 생산된 전력으로 추진 전동기를 구동한다. "
        "전기 추진은 기계적 축 연결이 불필요하여 원자로 배치의 자유도를 높이며, "
        "프로펠러 회전수의 정밀 제어가 가능하다."
    )

    pdf.add_table(
        headers=["항목", "사양"],
        rows=[
            ["형식", "영구자석 동기 전동기 (PMSM)"],
            ["정격 출력", "14 MW"],
            ["전압", "690 V, 3상"],
            ["회전수", "0~120 rpm (VFD 제어)"],
            ["효율", "96% (정격)"],
            ["중량", "~35 톤"],
            ["프로펠러", "고정 피치, 직경 7.5 m"],
        ],
        col_widths=[40, 125],
        title="표 8.12 추진 전동기 사양"
    )

    pdf.subsection_title("8.8.4 비상 전원")

    pdf.body_text(
        "원자로 정지 시 또는 동력변환 계통 고장 시 비상 전원을 확보하기 위해 "
        "다음 비상 전원 시스템을 구비한다:"
    )

    pdf.add_bullet_list([
        "비상 디젤 발전기: 1,000 kW x 2대 (이중화), 자동 기동(10초 이내)",
        "축전지(배터리): 200 kWh UPS, 핵계측/제어 30분 유지",
        "비상 용도: 붕괴열 제거 펌프, 제어계통, 비상 조명, 통신",
        "설계 기준: IAEA SSR-2/1 심층방어 원칙에 따른 다중성 확보",
    ])

    # ===================================================================
    # 8.9 보조 계통
    # ===================================================================
    pdf.section_title("8.9 보조 계통")

    pdf.subsection_title("8.9.1 불활성 가스 계통")

    pdf.body_text(
        "MSR의 1차 계통 상부 공간(cover gas)에 헬륨(He)을 공급하여 "
        "연료염과 공기의 접촉을 방지한다. 동시에 핵분열에 의해 생성되는 "
        "기체상 핵분열생성물(Kr-85, Xe-133 등)을 헬륨 퍼지 가스와 함께 "
        "추출하여 홀드업 탱크에 저장, 붕괴시킨 후 제어 방출한다."
    )

    pdf.add_bullet_list([
        "Cover gas: 고순도 헬륨 (99.999%)",
        "퍼지 유량: ~1 L/min",
        "오프가스 홀드업 탱크: 30일 용량 (Xe-133 반감기 5.2일 고려)",
        "활성탄 흡착기: Kr-85 지연 방출",
    ])

    pdf.subsection_title("8.9.2 연료염 처리 계통")

    pdf.body_text(
        "온라인 연료염 처리는 MSR의 고유 장점 중 하나로, 다음 기능을 수행한다:"
    )

    pdf.add_bullet_list([
        "불화물 휘발(fluoride volatility): UF₆ 형태로 우라늄 추출/정제",
        "귀금속(Noble metal) 제거: 핵분열 생성물 중 Ru, Mo 등 제거",
        "산화환원 제어: UF₃/UF₄ 비율 조절로 구조재 부식 억제",
        "삼중수소(tritium) 제거: ⁶Li(n,alpha)T 반응에 의한 T 생성물 포집",
    ])

    pdf.subsection_title("8.9.3 냉각수 계통")

    pdf.body_text(
        "sCO₂ 전냉각기, 각종 열교환기, 발전기, 전동기 등의 냉각을 위해 "
        "해수 냉각 시스템을 구성한다. 주요 사양은 다음과 같다:"
    )

    pdf.add_bullet_list([
        "냉각 방열: ~24 MW (40 MWth - 16 MWe)",
        "해수 펌프: 2대 (1 운전 + 1 대기), 각 2,000 m³/hr",
        "해수 입구 온도: 15~30도C (항로 기반 설계 범위)",
        "해수 출구 온도: < 40도C (해양 환경 규제)",
        "재질: 해수 접촉부 Ti 합금 또는 Cu-Ni 합금 (내식성)",
    ])

    pdf.subsection_title("8.9.4 환기 및 HVAC")

    pdf.body_text(
        "기관실 내 온도 제어, 방사성 오염 방지, 승무원 거주 환경 유지를 위해 "
        "환기/공조(HVAC) 시스템을 구비한다:"
    )

    pdf.add_bullet_list([
        "원자로 구획: 부압 유지 (오염 확산 방지), 배기 필터링 (HEPA + 활성탄)",
        "기관실 일반 구역: 기계환기, 온도 25~35도C 유지",
        "승무원 구역: 전량 외기 도입, 쾌적 환경 유지",
        "비상 환기: 독립 계통, 원자로 구획 격리 가능",
    ])

    # ===================================================================
    # 8.10 기관실 배치 개념
    # ===================================================================
    pdf.section_title("8.10 기관실 배치 개념")

    pdf.body_text(
        "기관실(25 m x 20 m x 12 m)을 5개 기능 구역으로 분할하여 원자로 시스템 및 "
        "관련 계통을 배치한다. 구역 분리는 방사선 차폐, 화재 방호, 정비 접근성, "
        "안전 경로의 확보를 고려한다."
    )

    pdf.subsection_title("8.10.1 구역별 배치")

    pdf.add_table(
        headers=["구역", "배치 항목", "면적 [m²]", "특성"],
        rows=[
            ["A: 원자로 구역", "원자로+차폐, 비상배수탱크", "~50", "방사화, 접근 제한"],
            ["B: 중간루프 구역", "중간루프 HX, 펌프, 배관", "~30", "비방사화"],
            ["C: 동력변환 구역", "sCO₂ 터빈, 압축기, 발전기", "~80", "고온 고압"],
            ["D: 전기/제어 구역", "배전반, 변환기, 제어실", "~40", "저소음"],
            ["E: 보조기기 구역", "해수 펌프, HVAC, 비상발전기", "~50", "다목적"],
            ["정비/통로 공간", "접근 통로, 정비 공간", "~250", "최소 1.5 m 폭"],
        ],
        col_widths=[35, 50, 25, 55],
        title="표 8.13 기관실 구역별 배치"
    )

    pdf.subsection_title("8.10.2 구역 분리 원칙")

    pdf.body_text(
        "구역 분리는 다음 원칙에 따른다:"
    )

    pdf.add_numbered_list([
        "방사선 구역과 비방사선 구역의 명확한 경계 설정 (차폐 경계)",
        "고온 구역(동력변환)과 전기 구역의 열적 분리",
        "화재 구획: A60 등급 방화 격벽으로 구역 간 화재 확산 방지",
        "침수 격벽: 수밀 격벽으로 기관실 침수 시 중요 계통 보호",
        "비상 탈출: 각 구역에서 2방향 이상의 탈출 경로 확보",
    ])

    pdf.subsection_title("8.10.3 차폐 경계")

    pdf.body_text(
        "방사선 차폐 경계는 원자로 구획(구역 A)을 완전히 둘러싸며, "
        "제7장에서 설계된 4층 차폐(총 162 cm)가 적용된다. 차폐 경계를 관통하는 "
        "모든 배관에는 S자형 굴곡(offset bend) 및 추가 차폐 슬리브를 적용하여 "
        "스트리밍을 방지한다. 차폐 경계 내부는 평상시 무인 구역으로 원격 감시하며, "
        "정비 접근은 원자로 정지 후 규정 대기시간 경과 후에만 허용한다."
    )

    # ===================================================================
    # 8.11 선박 통합 요약
    # ===================================================================
    pdf.section_title("8.11 선박 통합 요약")

    pdf.body_text(
        "40 MWth MSR의 6,000 TEU 파나막스급 컨테이너선 통합 설계 결과를 종합한다."
    )

    pdf.add_table(
        headers=["항목", "결과", "판정"],
        rows=[
            ["총 시스템 중량", "~386 톤", "기존 디젤 대비 5,364톤 경량"],
            ["기관실 체적 점유율", "~5.0%", "충분한 여유 공간"],
            ["추진 출력", "14 MW (축출력)", "서비스 속력 18 kn 확보"],
            ["동력변환 효율", "40% (sCO₂ Brayton)", "컴팩트 고효율"],
            ["전기 추진", "14 MW PMSM", "유연한 배치"],
            ["차폐 외경/높이", "5.0 m / 5.8 m", "기관실 내 적합"],
            ["기초 볼트 안전율", "> 3.0", "DNV GL 만족"],
            ["자유 표면 GG'", "0.003 mm", "무시 가능"],
            ["비상 전원", "1,000 kW x 2 + UPS", "이중화"],
            ["20년 연료비 절감", "2.4~3.8억 USD", "경제적 우위"],
            ["CO₂ 절감", "~112,000 톤/년", "무탄소 운항"],
        ],
        col_widths=[40, 50, 75],
        title="표 8.14 선박 통합 종합 결과"
    )

    pdf.body_text(
        "종합적으로, 40 MWth MSR은 6,000 TEU 파나막스급 컨테이너선의 기관실에 "
        "중량, 체적, 구조 하중 측면에서 충분히 수용 가능함을 확인하였다. "
        "차폐 중량(~250톤)이 전체 시스템의 65%를 차지하여 중량 최적화의 여지가 "
        "있으나, 기존 디젤 추진 시스템 대비 절대적 중량에서 크게 유리하다. "
        "sCO₂ 브레이턴 사이클의 컴팩트 특성이 공간 적합성에 결정적으로 기여하며, "
        "전기 추진 방식은 배치 유연성과 운전 편의성을 제공한다. "
        "20년 운항 기간 동안의 연료비 절감과 무탄소 운항은 강력한 경제적·환경적 "
        "이점을 제공한다."
    )
